\hypertarget{Root__finding_8cpp}{}\section{Examples/\+Root\+\_\+finding.cpp File Reference}
\label{Root__finding_8cpp}\index{Examples/\+Root\+\_\+finding.\+cpp@{Examples/\+Root\+\_\+finding.\+cpp}}


Examples of the numerical solution of equations using Newton\textquotesingle{}s method and arc-\/length continuation and the solution of polynomial equations.  


{\ttfamily \#include \char`\"{}Luna/\+Core\char`\"{}}\newline
Include dependency graph for Root\+\_\+finding.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=217pt]{Root__finding_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classLuna_1_1test__residual}{Luna\+::test\+\_\+residual}
\item 
class \hyperlink{classLuna_1_1Arc__problem}{Luna\+::\+Arc\+\_\+problem}
\end{DoxyCompactItemize}
\subsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \hyperlink{namespaceLuna}{Luna}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{Root__finding_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{main} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Examples of the numerical solution of equations using Newton\textquotesingle{}s method and arc-\/length continuation and the solution of polynomial equations. 



\subsection{Function Documentation}
\mbox{\Hypertarget{Root__finding_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}\label{Root__finding_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{Root\+\_\+finding.\+cpp@{Root\+\_\+finding.\+cpp}!main@{main}}
\index{main@{main}!Root\+\_\+finding.\+cpp@{Root\+\_\+finding.\+cpp}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 51 of file Root\+\_\+finding.\+cpp.



References Luna\+::\+Newton$<$ T $>$\+::arclength\+\_\+solve(), Luna\+::\+Polynomial$<$ T $>$\+::coeffs(), f, Luna\+::\+Arclength$<$ T $>$\+::init\+\_\+arc(), Luna\+::\+Arc\+\_\+problem\+::p, Luna\+::\+Polynomial$<$ T $>$\+::quadratic\+\_\+solve(), Luna\+::\+Polynomial$<$ T $>$\+::roots(), Luna\+::\+Newton$<$ T $>$\+::solve(), and Heat\+\_\+plot\+::u.


\begin{DoxyCode}
52 \{
53   cout << \textcolor{stringliteral}{"----------------- Root finding -----------------"} << endl;
54 
55   cout << \textcolor{stringliteral}{" * Solving the set of equations "} << endl
56        << \textcolor{stringliteral}{" * x^3 + y - 1 = 0, "} << endl
57        << \textcolor{stringliteral}{" * y^3 - x + 1 = 0, "} << endl
58        << \textcolor{stringliteral}{" * using Newton's method and the initial guess "} << endl;
59 
60   \hyperlink{classLuna_1_1test__residual}{Luna::test\_residual} Res;                           \textcolor{comment}{// Create residual}
61   \hyperlink{classLuna_1_1Vector}{Vector<double>} x\_0(2, 0.5);                        \textcolor{comment}{// Initial guess}
62   x\_0[1] = 0.25;
63   cout << \textcolor{stringliteral}{" * x\_0 = "} << x\_0 << endl;
64   \hyperlink{classLuna_1_1Newton}{Luna::Newton<double>} newton( &Res );               \textcolor{comment}{// Create Newton object}
65   newton.solve( x\_0 );                               \textcolor{comment}{// Solve the system}
66 
67   cout << \textcolor{stringliteral}{" * gives the solution (x,y)= "} << x\_0 << endl;
68 
69   cout << endl << \textcolor{stringliteral}{"----- Arc continuation of x^2 + p^2 = 2.0 -----"} << endl;
70 
71   \textcolor{comment}{// Instantiate the problem}
72   \hyperlink{classLuna_1_1Arc__problem}{Luna::Arc\_problem} arc\_prob;
73   arc\_prob.\hyperlink{classLuna_1_1Arc__problem_ab747ff77d23c83ebf8e0e8ab58e9c432}{p} = 1.0;
74 
75   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-6;
76   \textcolor{comment}{// Scalar newton iteration problem}
77   \hyperlink{classLuna_1_1Newton}{Luna::Newton<double>} newton\_arc( &arc\_prob, 8, tol );
78 
79   \textcolor{comment}{// Initial guess}
80   \hyperlink{classLuna_1_1Vector}{Vector<double>} state( 1, 1.0 );
81   \textcolor{keywordtype}{double} arc\_step( 0.1 );
82   \textcolor{keywordtype}{double} max\_arc\_step( 0.5 );
83   newton\_arc.init\_arc( state, &arc\_prob.\hyperlink{classLuna_1_1Arc__problem_ab747ff77d23c83ebf8e0e8ab58e9c432}{p}, arc\_step, max\_arc\_step );
84 
85   \textcolor{keywordflow}{do}
86   \{
87     newton\_arc.arclength\_solve( state );
88     cout << \textcolor{stringliteral}{"x = "} << state[ 0 ] << \textcolor{stringliteral}{", p = "} << arc\_prob.\hyperlink{classLuna_1_1Arc__problem_ab747ff77d23c83ebf8e0e8ab58e9c432}{p} << endl;
89   \}\textcolor{keywordflow}{while}( state[ 0 ] < 1.0 );
90 
91   cout << endl << \textcolor{stringliteral}{"--------- Polynomial equations ---------"} << endl;
92   cout << \textcolor{stringliteral}{" * Define the function f(x) = -1 + 2x + x^2"} << endl;
93   \hyperlink{classLuna_1_1Polynomial}{Luna::Polynomial<double>} \hyperlink{Nonlinear__ODE__BVP_8cpp_a06fc87d81c62e9abb8790b6e5713c55ba7ce756344023b99e5ab27b804feb765c}{f}( std::vector<double> \{ -1.0, 2.0, 1.0, 1.0 \} );
94   cout << \textcolor{stringliteral}{" * Access the x coefficient f[1] = "} << \hyperlink{Nonlinear__ODE__BVP_8cpp_a06fc87d81c62e9abb8790b6e5713c55ba7ce756344023b99e5ab27b804feb765c}{f}[1] << endl;
95   cout << \textcolor{stringliteral}{" * Evaluate the polynomial at x = 0.1 "} << endl
96        << \textcolor{stringliteral}{" * f( 0.1 ) = "} << \hyperlink{Nonlinear__ODE__BVP_8cpp_a06fc87d81c62e9abb8790b6e5713c55ba7ce756344023b99e5ab27b804feb765c}{f}( 0.1 ) << endl << endl;
97 
98   cout << \textcolor{stringliteral}{" * Solve the complex quadratic equation "} << endl
99        << \textcolor{stringliteral}{" * ( 1 + i )x^2 - ( 2 + i )x - 1 = 0 "} << endl;
100   \hyperlink{classLuna_1_1Polynomial}{Luna::Polynomial< std::complex<double>} > p;
101   std::complex<double> a ( 1.0, 1.0 );
102   std::complex<double> b ( - 2.0, - 1.0 );
103   std::complex<double> c ( - 1.0, 0.0 );
104   \hyperlink{classLuna_1_1Vector}{Vector< std::complex<double>} > roots;
105   roots = p.\hyperlink{classLuna_1_1Polynomial_a801a06a8f76a415ce1368daea1c77abb}{quadratic\_solve}( a, b, c );
106   cout << \textcolor{stringliteral}{" * The two roots of the equation are"} << endl;
107   cout << \textcolor{stringliteral}{" * x\_0 = "} << roots[ 0 ] << endl;
108   cout << \textcolor{stringliteral}{" * x\_1 = "} << roots[ 1 ] << endl << endl;
109 
110   cout << \textcolor{stringliteral}{" * Solve the cubic equation"} << endl
111        << \textcolor{stringliteral}{" * 2x^3 + x^2 + 2x - 1 = 0 "} << endl;
112   \hyperlink{classLuna_1_1Vector}{Vector<std::complex<double>}> f\_roots;
113   f\_roots = \hyperlink{Nonlinear__ODE__BVP_8cpp_a06fc87d81c62e9abb8790b6e5713c55ba7ce756344023b99e5ab27b804feb765c}{f}.cubic\_solve( 2.0, 1.0, 2.0, - 1.0 );
114   cout << \textcolor{stringliteral}{" * The three roots of the equation are"} << endl;
115   cout << \textcolor{stringliteral}{" * x\_0 = "} << f\_roots[ 0 ] << endl;
116   cout << \textcolor{stringliteral}{" * x\_1 = "} << f\_roots[ 1 ] << endl;
117   cout << \textcolor{stringliteral}{" * x\_2 = "} << f\_roots[ 2 ] << endl << endl;
118 
119   cout << \textcolor{stringliteral}{" * Dividing the polynomial u(x) = x^3 - 2x^2 - 4"} << endl
120        << \textcolor{stringliteral}{" * by v(x) = x - 3 gives the quotient "} << endl;
121   \hyperlink{classLuna_1_1Polynomial}{Polynomial<double>} \hyperlink{namespaceHeat__plot_ae622b86afa46daa3e9b887624ab1bf26}{u}( std::vector<double> \{ -4.0, 0.0, -2.0, 1.0 \} );
122   \hyperlink{classLuna_1_1Polynomial}{Polynomial<double>} v( std::vector<double> \{ -3.0, 1.0 \} );
123   \hyperlink{classLuna_1_1Polynomial}{Polynomial<double>} q, r;
124   \hyperlink{namespaceHeat__plot_ae622b86afa46daa3e9b887624ab1bf26}{u}.polydiv( v, q, r );
125   cout << \textcolor{stringliteral}{" * q(x) = "} << q.\hyperlink{classLuna_1_1Polynomial_ab5e966c308b7e66d9c1c20666926db34}{coeffs}()[0] << \textcolor{stringliteral}{" + "} << q.\hyperlink{classLuna_1_1Polynomial_ab5e966c308b7e66d9c1c20666926db34}{coeffs}()[1] << \textcolor{stringliteral}{"x + "}
126        << q.\hyperlink{classLuna_1_1Polynomial_ab5e966c308b7e66d9c1c20666926db34}{coeffs}()[2] << \textcolor{stringliteral}{"x^2"} << endl
127        << \textcolor{stringliteral}{" * and the remainder "} << endl
128        << \textcolor{stringliteral}{" * r(x) = "} << r.\hyperlink{classLuna_1_1Polynomial_ab5e966c308b7e66d9c1c20666926db34}{coeffs}() << endl
129        << \textcolor{stringliteral}{" * such that u(x) = q(x) * v(x) + r(x)."} << endl << endl;
130 
131   cout << \textcolor{stringliteral}{" * Find the roots of the quartic equation "} << endl
132        << \textcolor{stringliteral}{" * 3 + x + x^2 + x^4 = 0 using Laguerre's method. "} << endl;
133   \hyperlink{classLuna_1_1Polynomial}{Polynomial<double>} poly( std::vector<double> \{ 3.0, 1.0, 1.0, 0.0, 1.0 \} );
134   \hyperlink{classLuna_1_1Vector}{Vector<std::complex<double>}> poly\_roots;
135   poly\_roots = poly.\hyperlink{classLuna_1_1Polynomial_ab045b5ac29660de6d5a54246ed1bec70}{roots}( \textcolor{keyword}{true} );
136   cout << \textcolor{stringliteral}{" * The roots of the equation are"} << endl
137        << \textcolor{stringliteral}{" * x\_0 = "} << poly\_roots[0] << endl
138        << \textcolor{stringliteral}{" * x\_1 = "} << poly\_roots[1] << endl
139        << \textcolor{stringliteral}{" * x\_2 = "} << poly\_roots[2] << endl
140        << \textcolor{stringliteral}{" * x\_3 = "} << poly\_roots[3] << endl << endl;
141 
142   cout << \textcolor{stringliteral}{"--- FINISHED ---"} << endl;
143 \}
\end{DoxyCode}
