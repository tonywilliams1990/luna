\hypertarget{ODE__BVP__test_8cpp}{}\section{Examples/\+O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.cpp File Reference}
\label{ODE__BVP__test_8cpp}\index{Examples/\+O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp@{Examples/\+O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp}}


T\+O\+DO description / rename file.  


{\ttfamily \#include \char`\"{}Luna/\+Core\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Luna/\+O\+DE\char`\"{}}\newline
Include dependency graph for O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=231pt]{ODE__BVP__test_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classLuna_1_1test__equation}{Luna\+::test\+\_\+equation}
\item 
class \hyperlink{classLuna_1_1left__BC}{Luna\+::left\+\_\+\+BC}
\item 
class \hyperlink{classLuna_1_1right__BC}{Luna\+::right\+\_\+\+BC}
\end{DoxyCompactItemize}
\subsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \hyperlink{namespaceLuna}{Luna}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y}, 
\hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae006cbf64cf3ff4ee152bf490ae2e2a7}{yd}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{ODE__BVP__test_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{main} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
T\+O\+DO description / rename file. 



\subsection{Enumeration Type Documentation}
\mbox{\Hypertarget{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7}\label{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7}} 
\subsubsection{\texorpdfstring{anonymous enum}{anonymous enum}}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{y@{y}!O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp@{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp}}\index{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp@{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp}!y@{y}}}\mbox{\Hypertarget{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}\label{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}} 
y&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{yd@{yd}!O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp@{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp}}\index{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp@{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp}!yd@{yd}}}\mbox{\Hypertarget{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae006cbf64cf3ff4ee152bf490ae2e2a7}\label{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae006cbf64cf3ff4ee152bf490ae2e2a7}} 
yd&\\
\hline

\end{DoxyEnumFields}


Definition at line 9 of file O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp.


\begin{DoxyCode}
9 \{ \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y}, \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae006cbf64cf3ff4ee152bf490ae2e2a7}{yd} \};
\end{DoxyCode}


\subsection{Function Documentation}
\mbox{\Hypertarget{ODE__BVP__test_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}\label{ODE__BVP__test_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp@{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp}!main@{main}}
\index{main@{main}!O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp@{O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 63 of file O\+D\+E\+\_\+\+B\+V\+P\+\_\+test.\+cpp.



References Luna\+::\+Vector$<$ T $>$\+::linspace(), Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::max\+\_\+iterations(), Heat\+\_\+plot\+::N, Luna\+::\+Mesh1\+D$<$ T, X $>$\+::output(), Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::set\+\_\+monitor\+\_\+det(), Luna\+::\+Vector$<$ T $>$\+::size(), Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::solution(), Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::solve\+\_\+bvp(), Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::tolerance(), Heat\+\_\+plot\+::x, y, and yd.


\begin{DoxyCode}
64 \{
65   cout << \textcolor{stringliteral}{"--------------------- ODE\_BVP --------------------"} << endl;
66 
67   \textcolor{comment}{// Setup the domain}
68 
69   \textcolor{keywordtype}{double} left( 0.0 );               \textcolor{comment}{// Left boundary}
70   \textcolor{keywordtype}{double} right( M\_PI / 4.0 );             \textcolor{comment}{// Right boundary}
71     std::size\_t \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N}( 1000 );            \textcolor{comment}{// Number of nodes}
72     \hyperlink{classLuna_1_1Vector}{Vector<double>} nodes;                       \textcolor{comment}{// Vector of nodes ( uniformly spaced )}
73     nodes.\hyperlink{classLuna_1_1Vector_a275847fc0bddea86c66651201a6db82e}{linspace}( left, right, \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N});
74 
75   \textcolor{comment}{// Create instances of the equation and BCs}
76   \hyperlink{classLuna_1_1test__equation}{test\_equation} equation;
77   \hyperlink{classLuna_1_1left__BC}{left\_BC} left\_bc;
78   \hyperlink{classLuna_1_1right__BC}{right\_BC} right\_bc;
79 
80   \textcolor{comment}{// Create boundary value problem}
81   \hyperlink{classLuna_1_1ODE__BVP}{ODE\_BVP<double>} ode( &equation, nodes, &left\_bc, &right\_bc );
82 
83   \textcolor{comment}{/* ----- Set the initial guess ----- */}
84   \textcolor{comment}{// y = (48/pi)x - 2 (linear fit to boundary conditions)}
85   \textcolor{keywordtype}{double} gradient( 48.0 / M\_PI );
86     \textcolor{keywordflow}{for} (std::size\_t j=0; j < \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N}; ++j )
87     \{
88         \textcolor{keywordtype}{double} \hyperlink{namespaceHeat__plot_aa88370c16b85b784ccbde3ed88bc1991}{x} = nodes[ j ];
89         ode.solution()( j, \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} )  = gradient * x - 2.0;
90     ode.solution()( j, \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae006cbf64cf3ff4ee152bf490ae2e2a7}{yd} ) = gradient;
91     \}
92 
93   ode.tolerance() = 1e-8;
94   ode.max\_iterations() = 50;
95   ode.set\_monitor\_det( \textcolor{keyword}{false} );
96 
97   \textcolor{comment}{// Adaptively solve the BVP}
98   \textcolor{comment}{//ode.adapt\_until( 1e-7 );}
99 
100   cout << \textcolor{stringliteral}{" Number of nodes in the solution = "} << ode.solution().nnodes()
101        << endl;
102 
103   nodes = ode.solution().nodes();
104   \hyperlink{classLuna_1_1Mesh1D}{Mesh1D<double, double>} exact\_solution( nodes, 2 );
105   \textcolor{keywordflow}{for} (std::size\_t j=0; j < nodes.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}(); ++j )
106     \{
107         \textcolor{keywordtype}{double} x = nodes[ j ];
108         exact\_solution( j, \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} )  = - 2.0 * cos( 2 * x ) + 10.0 * sin( 2 * x );
109     exact\_solution( j, \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae006cbf64cf3ff4ee152bf490ae2e2a7}{yd} ) =   4.0 * sin( 2 * x ) + 20.0 * cos( 2 * x );
110     \}
111   \textcolor{comment}{// Solve}
112   ode.solve\_bvp();
113 
114   \textcolor{comment}{// Output the solution data}
115   ode.solution().output( \textcolor{stringliteral}{"./DATA/ODE\_BVP\_numerical\_solution.dat"} );
116   exact\_solution.output( \textcolor{stringliteral}{"./DATA/ODE\_BVP\_exact\_solution.dat"} );
117 
118   \textcolor{comment}{//TODO plotting instructions}
119 
120   cout << \textcolor{stringliteral}{"--- FINISHED ---"} << endl;
121 \}
\end{DoxyCode}
