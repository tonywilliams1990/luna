\hypertarget{classLuna_1_1ODE__BVP}{}\section{Luna\+:\+:O\+D\+E\+\_\+\+B\+VP$<$ T, X $>$ Class Template Reference}
\label{classLuna_1_1ODE__BVP}\index{Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$@{Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$}}


A templated object for boundary-\/value problems as systems of first-\/order ordinary differential equations.  




{\ttfamily \#include $<$O\+D\+E\+\_\+\+B\+V\+P.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classLuna_1_1ODE__BVP_adc692c5395375409ac3df8ec8b9ec32b}{O\+D\+E\+\_\+\+B\+VP} (\hyperlink{classLuna_1_1Equation__1matrix}{Equation\+\_\+1matrix}$<$ T, X $>$ $\ast$ptr\+\_\+equation, const \hyperlink{classLuna_1_1Vector}{Vector}$<$ X $>$ \&nodes, \hyperlink{classLuna_1_1Residual}{Residual}$<$ T $>$ $\ast$ptr\+\_\+left\+\_\+residual, \hyperlink{classLuna_1_1Residual}{Residual}$<$ T $>$ $\ast$ptr\+\_\+right\+\_\+residual)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \hyperlink{classLuna_1_1ODE__BVP_af4ad8cb4bd83a9e41c02bbcf8d28022e}{$\sim$\+O\+D\+E\+\_\+\+B\+VP} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Mesh1D}{Mesh1D}$<$ T, X $>$ \& \hyperlink{classLuna_1_1ODE__BVP_af869c5d4c32de3e2c6dce128f86379a7}{solution} ()
\begin{DoxyCompactList}\small\item\em Return a pointer to the current solution mesh. \end{DoxyCompactList}\item 
double \& \hyperlink{classLuna_1_1ODE__BVP_a9b3eeb599a5d12ebb6bab1b80ff02844}{tolerance} ()
\begin{DoxyCompactList}\small\item\em Access the tolerance for convergence. \end{DoxyCompactList}\item 
int \& \hyperlink{classLuna_1_1ODE__BVP_ad013352e3aa277825cbac01d6334554b}{max\+\_\+iterations} ()
\begin{DoxyCompactList}\small\item\em Access the maximum number of iterations. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1ODE__BVP_a6bf2f309333522cf1a4d251580ee56d5}{set\+\_\+monitor\+\_\+det} (bool monitor)
\begin{DoxyCompactList}\small\item\em Set whether the determinant will be monitored. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1ODE__BVP_ae035272ad664be6ad5334f1b93a86b15}{solve\+\_\+bvp} ()
\begin{DoxyCompactList}\small\item\em Solve the boundary value problem. \end{DoxyCompactList}\item 
std\+::pair$<$ unsigned, unsigned $>$ \hyperlink{classLuna_1_1ODE__BVP_af132e3f1f22a87bd2505c556cd6e0993}{adapt} (const double \&adapt\+\_\+tol)
\begin{DoxyCompactList}\small\item\em Adapt the computational mesh. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1ODE__BVP_a504f92ae04c8ab1ccd2b1ba96c09b79e}{adapt\+\_\+until} (const double \&adapt\+\_\+tol)
\begin{DoxyCompactList}\small\item\em Solve the system with mesh refinements or unrefinements. \end{DoxyCompactList}\item 
{\footnotesize template$<$$>$ }\\std\+::pair$<$ unsigned, unsigned $>$ \hyperlink{classLuna_1_1ODE__BVP_a8da2eba83d2bb58a5e87f77ce3620056}{adapt} (const double \&adapt\+\_\+tol)
\item 
{\footnotesize template$<$$>$ }\\std\+::pair$<$ unsigned, unsigned $>$ \hyperlink{classLuna_1_1ODE__BVP_a59d055c7eb9058184aa86d5514d615e5}{adapt} (const double \&adapt\+\_\+tol)
\item 
{\footnotesize template$<$$>$ }\\void \hyperlink{classLuna_1_1ODE__BVP_a5158d9bd406cfea3eaa7f98f5fc74d44}{adapt\+\_\+until} (const double \&adapt\+\_\+tol)
\item 
{\footnotesize template$<$$>$ }\\void \hyperlink{classLuna_1_1ODE__BVP_a5127af573d557a9640fdff989e9f7e69}{adapt\+\_\+until} (const double \&adapt\+\_\+tol)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$class T, class X = double$>$\newline
class Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$}

A templated object for boundary-\/value problems as systems of first-\/order ordinary differential equations. 



Definition at line 51 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_adc692c5395375409ac3df8ec8b9ec32b}\label{classLuna_1_1ODE__BVP_adc692c5395375409ac3df8ec8b9ec32b}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!O\+D\+E\+\_\+\+B\+VP@{O\+D\+E\+\_\+\+B\+VP}}
\index{O\+D\+E\+\_\+\+B\+VP@{O\+D\+E\+\_\+\+B\+VP}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{O\+D\+E\+\_\+\+B\+V\+P()}{ODE\_BVP()}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
\hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::\hyperlink{classLuna_1_1ODE__BVP}{O\+D\+E\+\_\+\+B\+VP} (\begin{DoxyParamCaption}\item[{\hyperlink{classLuna_1_1Equation__1matrix}{Equation\+\_\+1matrix}$<$ T, X $>$ $\ast$}]{ptr\+\_\+equation,  }\item[{const \hyperlink{classLuna_1_1Vector}{Vector}$<$ X $>$ \&}]{nodes,  }\item[{\hyperlink{classLuna_1_1Residual}{Residual}$<$ T $>$ $\ast$}]{ptr\+\_\+left\+\_\+residual,  }\item[{\hyperlink{classLuna_1_1Residual}{Residual}$<$ T $>$ $\ast$}]{ptr\+\_\+right\+\_\+residual }\end{DoxyParamCaption})}



Constructor. 



Definition at line 117 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.


\begin{DoxyCode}
119                                              :
120            MAX\_ITER( 20 ), TOL( 1e-8 ), ptr\_EQUATION( ptr\_equation ),
121            ptr\_LEFT\_RESIDUAL( ptr\_left\_residual ),
122            ptr\_RIGHT\_RESIDUAL( ptr\_right\_residual ),
123            LAST\_DET\_SIGN( 0 ), MONITOR\_DET( \textcolor{keyword}{true} )
124   \{
125     SOLUTION = Mesh1D<T, X>( nodes, ptr\_EQUATION -> get\_order() );
126 
127     \textcolor{keywordtype}{unsigned} eqn\_order( ptr\_EQUATION -> get\_order() );
128     \textcolor{keywordtype}{unsigned} left\_vars( ptr\_LEFT\_RESIDUAL -> get\_number\_of\_vars() );
129     \textcolor{keywordtype}{unsigned} right\_vars( ptr\_RIGHT\_RESIDUAL -> get\_number\_of\_vars() );
130     \textcolor{keywordtype}{unsigned} left\_order( ptr\_LEFT\_RESIDUAL -> get\_order() );
131     \textcolor{keywordtype}{unsigned} right\_order( ptr\_RIGHT\_RESIDUAL -> get\_order() );
132 
133     \textcolor{keywordflow}{if} ( ( left\_vars != eqn\_order ) || ( right\_vars != eqn\_order ) ||
134          ( left\_order + right\_order != eqn\_order ) )
135     \{
136      std::cout << \textcolor{stringliteral}{"order "} << eqn\_order << std::endl;
137      std::cout << \textcolor{stringliteral}{"left nvars "} << left\_vars << std::endl;
138      std::cout << \textcolor{stringliteral}{"right nvars "} << right\_vars << std::endl;
139      std::cout << \textcolor{stringliteral}{"left order "} << left\_order << std::endl;
140      std::cout << \textcolor{stringliteral}{"right order "} << right\_order << std::endl;
141      std::string problem;
142      problem  = \textcolor{stringliteral}{"The ODE\_BVP equation and boundary conditions are not well\(\backslash\)n"};
143      problem += \textcolor{stringliteral}{"posed. The number of variables for each boundary condition\(\backslash\)n"};
144      problem += \textcolor{stringliteral}{"has to be the same as the order of the equation. Also the \(\backslash\)n"};
145      problem += \textcolor{stringliteral}{"order of both boundary conditions has to sum to the order\(\backslash\)n"};
146      problem += \textcolor{stringliteral}{"of the equation.\(\backslash\)n"};
147      \textcolor{keywordflow}{throw} Error( problem );
148     \}
149   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_af4ad8cb4bd83a9e41c02bbcf8d28022e}\label{classLuna_1_1ODE__BVP_af4ad8cb4bd83a9e41c02bbcf8d28022e}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!````~O\+D\+E\+\_\+\+B\+VP@{$\sim$\+O\+D\+E\+\_\+\+B\+VP}}
\index{````~O\+D\+E\+\_\+\+B\+VP@{$\sim$\+O\+D\+E\+\_\+\+B\+VP}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{$\sim$\+O\+D\+E\+\_\+\+B\+V\+P()}{~ODE\_BVP()}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
\hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::$\sim$\hyperlink{classLuna_1_1ODE__BVP}{O\+D\+E\+\_\+\+B\+VP} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Destructor. 



Definition at line 152 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.


\begin{DoxyCode}
153     \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_af132e3f1f22a87bd2505c556cd6e0993}\label{classLuna_1_1ODE__BVP_af132e3f1f22a87bd2505c556cd6e0993}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!adapt@{adapt}}
\index{adapt@{adapt}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{adapt()}{adapt()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
std\+::pair$<$ unsigned, unsigned $>$ \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::adapt (\begin{DoxyParamCaption}\item[{const double \&}]{adapt\+\_\+tol }\end{DoxyParamCaption})}



Adapt the computational mesh. 


\begin{DoxyParams}{Parameters}
{\em adapt\+\_\+tol} & The residual tolerance at a nodal point to determine whether mesh refinements will occur \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pair of values indicating the number of refinements and unrefinements. 
\end{DoxyReturn}


Definition at line 261 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.



References Heat\+\_\+plot\+::N, Luna\+::\+Vector$<$ T $>$\+::norm\+\_\+inf(), and Luna\+::\+Vector$<$ T $>$\+::push\+\_\+back().



Referenced by Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::adapt\+\_\+until().


\begin{DoxyCode}
262   \{
263     \textcolor{keywordtype}{unsigned} order( ptr\_EQUATION -> get\_order() );
264     \textcolor{keywordtype}{unsigned} \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N}( SOLUTION.nnodes() );
265 
266     Vector<T> F\_node( order, 0.0 );
267     Vector<T> R\_node( order, 0.0 );
268 
269     std::vector<bool> refine( \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N}, \textcolor{keyword}{false} );
270     std::vector<bool> unrefine( \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N}, \textcolor{keyword}{false} );
271 
272     Vector<double> Res2( \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N}, 0.0 );
273 
274     \textcolor{keywordflow}{for} ( std::size\_t node = 1; node <= \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N} - 2; node += 2 )
275     \{
276       \textcolor{comment}{// set the current solution at this node}
277       \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} var = 0; var < order; ++var )
278       \{
279          F\_node[ var ] = SOLUTION( node, var );
280       \}
281       \textcolor{comment}{// set the y-pos in the eqn}
282       ptr\_EQUATION -> coord(0) = SOLUTION.coord( node );
283       \textcolor{comment}{// Update the equation to the nodal position}
284       ptr\_EQUATION -> update( F\_node );
285       \textcolor{comment}{// step size centred at the node}
286       X invh = 1. / ( SOLUTION.coord( node + 1 ) - SOLUTION.coord( node - 1 ) );
287       \textcolor{comment}{// loop over all the variables}
288       Vector<T> temp( order, 0.0 );
289       \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} var = 0; var < order; ++var )
290       \{
291         temp[ var ] = ptr\_EQUATION -> residual()[ var ] - (
292                 SOLUTION( node + 1, var ) - SOLUTION( node - 1, var ) ) * invh;
293       \}
294       Res2[ node ] = temp.norm\_inf();
295       \textcolor{keywordflow}{if} ( Res2[ node ] > adapt\_tol )
296       \{
297         refine[ node ] = \textcolor{keyword}{true};
298       \}
299       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( Res2[ node ] < TOL / 10. )
300       \{
301         unrefine[ node ] = \textcolor{keyword}{true};
302       \}
303     \}
304 
305     std::size\_t no\_refined( 0 ), no\_unrefined( 0 );
306     \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < refine.size(); ++i )
307     \{
308       \textcolor{keywordflow}{if} ( refine[ i ] == \textcolor{keyword}{true} )\{ no\_refined++; \}
309       \textcolor{keywordflow}{if} ( unrefine[ i ] == \textcolor{keyword}{true} )\{ no\_unrefined++; \}
310     \}
311 
312     \textcolor{comment}{// make a new refined/unrefined mesh}
313     Vector<X> nodes( SOLUTION.nodes() );
314     Vector<X> newX;
315     newX.push\_back( nodes[ 0 ] );
316     \textcolor{keywordflow}{for} ( std::size\_t i = 1; i < \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N} - 1; ++i )
317     \{
318       \textcolor{keywordflow}{if} ( refine[ i ] )
319       \{
320         \textcolor{keywordflow}{if} ( !refine[ i - 1 ] )
321         \{
322           \textcolor{comment}{// Have not already refined to the left}
323           \textcolor{comment}{// so refine left AND right with new nodes}
324           X left( nodes[ i - 1 ] );
325           X right( nodes[ i + 1 ] );
326           X here( nodes[ i ] );
327           newX.push\_back( ( left + here ) / 2. );
328           newX.push\_back( here );
329           newX.push\_back( ( right + here ) / 2. );
330         \}
331         \textcolor{keywordflow}{else}
332         \{
333           \textcolor{comment}{// already left refined, so just refine right}
334           X right( nodes[ i + 1 ] );
335           X here( nodes[ i ] );
336           newX.push\_back( here );
337           newX.push\_back( ( right + here ) / 2. );
338         \}
339       \}
340       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !unrefine[ i ] )
341       \{
342         newX.push\_back( nodes[ i ] );
343       \}
344     \}
345     newX.push\_back( nodes[ N - 1 ] );
346 
347     SOLUTION.remesh( newX );
348 
349     LAST\_DET\_SIGN = 0;
350 
351     std::pair< unsigned, unsigned > feedback;
352     feedback.first = no\_refined;
353     feedback.second = no\_unrefined;
354     \textcolor{keywordflow}{return} feedback;
355   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_a8da2eba83d2bb58a5e87f77ce3620056}\label{classLuna_1_1ODE__BVP_a8da2eba83d2bb58a5e87f77ce3620056}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!adapt@{adapt}}
\index{adapt@{adapt}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{adapt()}{adapt()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template$<$$>$ \\
std\+::pair$<$ unsigned, unsigned $>$ \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ double, \hyperlink{namespaceLuna_af3257e90072a78a8ffb16a16773aa18e}{cmplx} $>$\+::adapt (\begin{DoxyParamCaption}\item[{const double \&}]{adapt\+\_\+tol }\end{DoxyParamCaption})}



Definition at line 239 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.


\begin{DoxyCode}
241   \{
242     std::string problem;
243     problem = \textcolor{stringliteral}{" The ODE\_BVP.adapt method has been called for a problem in \(\backslash\)n"};
244     problem += \textcolor{stringliteral}{" the complex plane. This doesn't make sense as the path is \(\backslash\)n"};
245     problem += \textcolor{stringliteral}{" not geometrically defined. \(\backslash\)n"};
246     \textcolor{keywordflow}{throw} Error( problem );
247   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_a59d055c7eb9058184aa86d5514d615e5}\label{classLuna_1_1ODE__BVP_a59d055c7eb9058184aa86d5514d615e5}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!adapt@{adapt}}
\index{adapt@{adapt}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{adapt()}{adapt()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$$>$ \\
std\+::pair$<$ unsigned, unsigned $>$ \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ \hyperlink{namespaceLuna_af3257e90072a78a8ffb16a16773aa18e}{cmplx}, \hyperlink{namespaceLuna_af3257e90072a78a8ffb16a16773aa18e}{cmplx} $>$\+::adapt (\begin{DoxyParamCaption}\item[{const double \&}]{adapt\+\_\+tol }\end{DoxyParamCaption})}



Definition at line 250 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.


\begin{DoxyCode}
252   \{
253     std::string problem;
254     problem = \textcolor{stringliteral}{" The ODE\_BVP.adapt method has been called for a problem in \(\backslash\)n"};
255     problem += \textcolor{stringliteral}{" the complex plane. This doesn't make sense as the path is \(\backslash\)n"};
256     problem += \textcolor{stringliteral}{" not geometrically defined. \(\backslash\)n"};
257     \textcolor{keywordflow}{throw} Error( problem );
258   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_a504f92ae04c8ab1ccd2b1ba96c09b79e}\label{classLuna_1_1ODE__BVP_a504f92ae04c8ab1ccd2b1ba96c09b79e}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!adapt\+\_\+until@{adapt\+\_\+until}}
\index{adapt\+\_\+until@{adapt\+\_\+until}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{adapt\+\_\+until()}{adapt\_until()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
void \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::adapt\+\_\+until (\begin{DoxyParamCaption}\item[{const double \&}]{adapt\+\_\+tol }\end{DoxyParamCaption})}



Solve the system with mesh refinements or unrefinements. 


\begin{DoxyParams}{Parameters}
{\em adapt\+\_\+tol} & The residual tolerance at a nodal point to determine whether mesh refinements will occur \\
\hline
\end{DoxyParams}


Definition at line 378 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.



References Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::adapt(), Luna\+::\+Vector$<$ T $>$\+::dot(), Luna\+::\+Banded\+Matrix$<$ T $>$\+::fill(), and Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::solve\+\_\+bvp().


\begin{DoxyCode}
379   \{
380     std::pair<unsigned, unsigned> changes;
381     \textcolor{keywordflow}{do} \{
382       changes = \hyperlink{classLuna_1_1ODE__BVP_af132e3f1f22a87bd2505c556cd6e0993}{adapt}( adapt\_tol );
383       \hyperlink{classLuna_1_1ODE__BVP_ae035272ad664be6ad5334f1b93a86b15}{solve\_bvp}();
384       std::cout << \textcolor{stringliteral}{" * Adapting: "} << changes.first << \textcolor{stringliteral}{" "} << changes.second
385                 << std::endl;
386     \}\textcolor{keywordflow}{while} ( changes.first + changes.second != 0 );
387   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_a5158d9bd406cfea3eaa7f98f5fc74d44}\label{classLuna_1_1ODE__BVP_a5158d9bd406cfea3eaa7f98f5fc74d44}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!adapt\+\_\+until@{adapt\+\_\+until}}
\index{adapt\+\_\+until@{adapt\+\_\+until}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{adapt\+\_\+until()}{adapt\_until()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template$<$$>$ \\
void \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ double, \hyperlink{namespaceLuna_af3257e90072a78a8ffb16a16773aa18e}{cmplx} $>$\+::adapt\+\_\+until (\begin{DoxyParamCaption}\item[{const double \&}]{adapt\+\_\+tol }\end{DoxyParamCaption})}



Definition at line 358 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.


\begin{DoxyCode}
359   \{
360     std::string problem;
361     problem = \textcolor{stringliteral}{" The ODE\_BVP.adapt\_until method has been called for a problem\(\backslash\)n"};
362     problem += \textcolor{stringliteral}{" in the complex plane. This doesn't make sense as the path\(\backslash\)n"};
363     problem += \textcolor{stringliteral}{" is not geometrically defined. \(\backslash\)n"};
364     \textcolor{keywordflow}{throw} Error( problem );
365   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_a5127af573d557a9640fdff989e9f7e69}\label{classLuna_1_1ODE__BVP_a5127af573d557a9640fdff989e9f7e69}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!adapt\+\_\+until@{adapt\+\_\+until}}
\index{adapt\+\_\+until@{adapt\+\_\+until}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{adapt\+\_\+until()}{adapt\_until()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$$>$ \\
void \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ \hyperlink{namespaceLuna_af3257e90072a78a8ffb16a16773aa18e}{cmplx}, \hyperlink{namespaceLuna_af3257e90072a78a8ffb16a16773aa18e}{cmplx} $>$\+::adapt\+\_\+until (\begin{DoxyParamCaption}\item[{const double \&}]{adapt\+\_\+tol }\end{DoxyParamCaption})}



Definition at line 368 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.


\begin{DoxyCode}
369   \{
370     std::string problem;
371     problem = \textcolor{stringliteral}{" The ODE\_BVP.adapt\_until method has been called for a problem\(\backslash\)n"};
372     problem += \textcolor{stringliteral}{" in the complex plane. This doesn't make sense as the path\(\backslash\)n"};
373     problem += \textcolor{stringliteral}{" is not geometrically defined. \(\backslash\)n"};
374     \textcolor{keywordflow}{throw} Error( problem );
375   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_ad013352e3aa277825cbac01d6334554b}\label{classLuna_1_1ODE__BVP_ad013352e3aa277825cbac01d6334554b}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!max\+\_\+iterations@{max\+\_\+iterations}}
\index{max\+\_\+iterations@{max\+\_\+iterations}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{max\+\_\+iterations()}{max\_iterations()}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
int \& \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::max\+\_\+iterations (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Access the maximum number of iterations. 

\begin{DoxyReturn}{Returns}
a pointer to the maximum number of iterations 
\end{DoxyReturn}


Definition at line 170 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.



Referenced by main().


\begin{DoxyCode}
171   \{
172     \textcolor{keywordflow}{return} MAX\_ITER;
173   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_a6bf2f309333522cf1a4d251580ee56d5}\label{classLuna_1_1ODE__BVP_a6bf2f309333522cf1a4d251580ee56d5}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!set\+\_\+monitor\+\_\+det@{set\+\_\+monitor\+\_\+det}}
\index{set\+\_\+monitor\+\_\+det@{set\+\_\+monitor\+\_\+det}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{set\+\_\+monitor\+\_\+det()}{set\_monitor\_det()}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
void \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::set\+\_\+monitor\+\_\+det (\begin{DoxyParamCaption}\item[{bool}]{monitor }\end{DoxyParamCaption})}



Set whether the determinant will be monitored. 


\begin{DoxyParams}{Parameters}
{\em monitor} & The boolean value determining whether the determinant will be monitored \\
\hline
\end{DoxyParams}


Definition at line 176 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.



Referenced by main().


\begin{DoxyCode}
177   \{
178     MONITOR\_DET = monitor;
179   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_af869c5d4c32de3e2c6dce128f86379a7}\label{classLuna_1_1ODE__BVP_af869c5d4c32de3e2c6dce128f86379a7}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!solution@{solution}}
\index{solution@{solution}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{solution()}{solution()}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
\hyperlink{classLuna_1_1Mesh1D}{Mesh1D}$<$ T, X $>$ \& \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::solution (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Return a pointer to the current solution mesh. 



Definition at line 158 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.



Referenced by main().


\begin{DoxyCode}
159   \{
160     \textcolor{keywordflow}{return} SOLUTION;
161   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_ae035272ad664be6ad5334f1b93a86b15}\label{classLuna_1_1ODE__BVP_ae035272ad664be6ad5334f1b93a86b15}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!solve\+\_\+bvp@{solve\+\_\+bvp}}
\index{solve\+\_\+bvp@{solve\+\_\+bvp}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{solve\+\_\+bvp()}{solve\_bvp()}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
void \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::solve\+\_\+bvp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Solve the boundary value problem. 



Definition at line 182 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.



References Luna\+::\+Banded\+Matrix$<$ T $>$\+::det(), Luna\+::\+Vector$<$ T $>$\+::norm\+\_\+inf(), and Luna\+::\+Banded\+Matrix$<$ T $>$\+::solve().



Referenced by Luna\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ T, X $>$\+::adapt\+\_\+until(), and main().


\begin{DoxyCode}
183   \{
184     \textcolor{keywordtype}{unsigned} order( ptr\_EQUATION -> get\_order() );
185     \textcolor{keywordtype}{unsigned} n( SOLUTION.nnodes() );
186     \textcolor{keywordtype}{double} max\_residual( 1.0 );
187     \textcolor{keywordtype}{int} counter( 0 );
188     \textcolor{keywordtype}{int} det\_sign( LAST\_DET\_SIGN );
189     \textcolor{comment}{// Banded LHS matrix}
190     BandedMatrix<T> a( n * order, 2 * order - 1, 2 * order - 1 );
191     \textcolor{comment}{// RHS vector}
192     Vector<T> b( n * order, 0.0 );
193     \textcolor{comment}{// Loop until convergence}
194     \textcolor{keywordflow}{do} \{
195       ++counter;
196       assemble\_matrix\_problem( a, b );
197       \textcolor{comment}{//TODO actions before linear solve ?}
198       max\_residual = b.norm\_inf();
199       b = a.solve( b );
200       \textcolor{comment}{// Put the solution into the 1D mesh}
201       \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < order; ++var )
202       \{
203         \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < n; ++i )
204         \{
205           SOLUTION( i, var ) += b[ i * order + var ];
206         \}
207       \}
208 
209     \} \textcolor{keywordflow}{while}( ( max\_residual > TOL ) && ( counter < MAX\_ITER ) );
210 
211     \textcolor{keywordflow}{if} ( counter >= MAX\_ITER )
212     \{
213       std::string problem( \textcolor{stringliteral}{"solve\_bvp method error: Too many iterations"} );
214       \textcolor{keywordflow}{throw} Error( problem );
215     \}
216 
217     \textcolor{keywordflow}{if} ( MONITOR\_DET )
218     \{
219       T det = a.det();
220       \textcolor{keywordflow}{if} ( std::real( det ) < 0 ) \{
221         det\_sign = -1;
222       \} \textcolor{keywordflow}{else} \{
223         det\_sign = 1;
224       \}
225       \textcolor{keywordflow}{if} ( det\_sign * LAST\_DET\_SIGN < 0 )
226       \{
227         LAST\_DET\_SIGN = det\_sign;
228         std::string problem;
229         problem = \textcolor{stringliteral}{"Determinant monitor has changed signs in ODE\_BVP.\(\backslash\)n"};
230         problem += \textcolor{stringliteral}{"Bifurcation detected.\(\backslash\)n"};
231         \textcolor{keywordflow}{throw} Error( problem );
232       \}
233       LAST\_DET\_SIGN = det\_sign;
234     \}
235   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1ODE__BVP_a9b3eeb599a5d12ebb6bab1b80ff02844}\label{classLuna_1_1ODE__BVP_a9b3eeb599a5d12ebb6bab1b80ff02844}} 
\index{Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}!tolerance@{tolerance}}
\index{tolerance@{tolerance}!Luna\+::\+O\+D\+E\+\_\+\+B\+VP@{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}}
\subsubsection{\texorpdfstring{tolerance()}{tolerance()}}
{\footnotesize\ttfamily template$<$typename T , typename X $>$ \\
double \& \hyperlink{classLuna_1_1ODE__BVP}{Luna\+::\+O\+D\+E\+\_\+\+B\+VP}$<$ T, X $>$\+::tolerance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Access the tolerance for convergence. 

\begin{DoxyReturn}{Returns}
a pointer to the tolerance 
\end{DoxyReturn}


Definition at line 164 of file O\+D\+E\+\_\+\+B\+V\+P.\+h.



Referenced by main().


\begin{DoxyCode}
165   \{
166     \textcolor{keywordflow}{return} TOL;
167   \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/\+Luna/\hyperlink{ODE__BVP_8h}{O\+D\+E\+\_\+\+B\+V\+P.\+h}\end{DoxyCompactItemize}
