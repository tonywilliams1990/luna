\hypertarget{Heat__equation_8cpp}{}\section{Examples/\+Heat\+\_\+equation.cpp File Reference}
\label{Heat__equation_8cpp}\index{Examples/\+Heat\+\_\+equation.\+cpp@{Examples/\+Heat\+\_\+equation.\+cpp}}


Solve the heat equation \[ u_t = \alpha u_{xx}, \] where $ \alpha $ is the thermal diffusivity, subject to the boudary conditions $ u(0,t)=u(1,t)=0 $ and the initial condition \[ u(x,0) = u_0(x) = 100 \sin( \pi x ). \] The numerical solution is found using the Crank-\/\+Nicolson method.  


{\ttfamily \#include \char`\"{}Luna/\+Core\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Luna/\+Sparse\char`\"{}}\newline
Include dependency graph for Heat\+\_\+equation.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=232pt]{Heat__equation_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{Heat__equation_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{main} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Solve the heat equation \[ u_t = \alpha u_{xx}, \] where $ \alpha $ is the thermal diffusivity, subject to the boudary conditions $ u(0,t)=u(1,t)=0 $ and the initial condition \[ u(x,0) = u_0(x) = 100 \sin( \pi x ). \] The numerical solution is found using the Crank-\/\+Nicolson method. 



\subsection{Function Documentation}
\mbox{\Hypertarget{Heat__equation_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}\label{Heat__equation_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{Heat\+\_\+equation.\+cpp@{Heat\+\_\+equation.\+cpp}!main@{main}}
\index{main@{main}!Heat\+\_\+equation.\+cpp@{Heat\+\_\+equation.\+cpp}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 16 of file Heat\+\_\+equation.\+cpp.



References Heat\+\_\+plot\+::dt, Heat\+\_\+plot\+::J, Luna\+::\+Vector$<$ T $>$\+::linspace(), Heat\+\_\+plot\+::N, Luna\+::\+Mesh2\+D$<$ T $>$\+::output(), Luna\+::\+Tridiagonal$<$ T $>$\+::solve(), and Luna\+::\+Utility\+::stringify().


\begin{DoxyCode}
17 \{
18   cout << \textcolor{stringliteral}{"---------------------- Heat equation ----------------------"} << endl;
19 
20   \textcolor{keywordtype}{double} T\_max( 1.0 );                \textcolor{comment}{// Maximum simulation time}
21   \textcolor{keywordtype}{int} \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N}( 200 );                       \textcolor{comment}{// Number of time steps}
22   \textcolor{keywordtype}{int} \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J}( 50 );                        \textcolor{comment}{// Number of spatial steps}
23   \textcolor{keywordtype}{double} \hyperlink{namespaceHeat__plot_ab03c1902ecb064f92219fa9cd5f140d1}{dt}( T\_max / ( 1. * \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N} ) );    \textcolor{comment}{// Time step}
24   \textcolor{keywordtype}{double} dx( 1.0 / \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} );               \textcolor{comment}{// Spatial step}
25   \textcolor{keywordtype}{double} alpha( 1.0 );                \textcolor{comment}{// Thermal diffusivity}
26 
27   cout << \textcolor{stringliteral}{" * Solving the heat equation u\_t = a u\_\{xx\} in the domain"} << endl
28        << \textcolor{stringliteral}{" * t=[0,"} + \hyperlink{namespaceLuna_1_1Utility_a7a21ee8e724765b7a018b6a5394b7e9c}{Utility::stringify}(T\_max) + \textcolor{stringliteral}{"] and x=[0,1] subject to "}
29        << \textcolor{stringliteral}{" the boundary conditions "} << endl << \textcolor{stringliteral}{" * u(0,t)=u(1,t)=0 and the "}
30        << \textcolor{stringliteral}{"initial condition u(x,0)=u\_0(x)."} << endl << \textcolor{stringliteral}{" * The initial "}
31        << \textcolor{stringliteral}{"condition u\_0(x) is specified in the code."}
32        << endl ;
33 
34   cout << \textcolor{stringliteral}{" * The spatial and time steps are:"} << endl;
35   cout << \textcolor{stringliteral}{" * dx = "} << dx << endl;
36   cout << \textcolor{stringliteral}{" * dt = "} << \hyperlink{namespaceHeat__plot_ab03c1902ecb064f92219fa9cd5f140d1}{dt} << endl;
37   cout << \textcolor{stringliteral}{" * and the number of spatial and time steps are:"} << endl;
38   cout << \textcolor{stringliteral}{" * J = "} << \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} << endl;
39   cout << \textcolor{stringliteral}{" * N = "} << \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N} << endl;
40 
41   \textcolor{keywordtype}{double} mu( alpha * \hyperlink{namespaceHeat__plot_ab03c1902ecb064f92219fa9cd5f140d1}{dt} / ( dx * dx ) );
42 
43   \textcolor{comment}{// Mesh for storing the solution}
44   \hyperlink{classLuna_1_1Vector}{Vector<double>} t\_nodes, x\_nodes;
45   t\_nodes.\hyperlink{classLuna_1_1Vector_a275847fc0bddea86c66651201a6db82e}{linspace}( 0.0, T\_max, \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N} + 1 );
46   x\_nodes.\hyperlink{classLuna_1_1Vector_a275847fc0bddea86c66651201a6db82e}{linspace}( 0.0, 1.0, \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} + 1 );
47   \hyperlink{classLuna_1_1Mesh2D}{Mesh2D<double>} solution( x\_nodes, t\_nodes, 1 );
48 
49   \textcolor{comment}{// Matrices for Crank-Nicolson method including BCs u(0,t) = u(1,t) = 0}
50   \hyperlink{classLuna_1_1Tridiagonal}{Tridiagonal<double>} Implicit( -mu, 2. + 2. * mu, -mu, \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} + 1 );
51   Implicit( 0, 0 )     = 1.0;
52   Implicit( 0, 1 )     = 0.0;
53   Implicit( \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J}, \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} - 1 ) = 0.0;
54   Implicit( \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J}, \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} )     = 1.0;
55 
56   \hyperlink{classLuna_1_1Tridiagonal}{Tridiagonal<double>} Explicit( mu, 2. - 2. * mu, mu, \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} + 1 );
57   Explicit( 0, 0 )     =   1.0;
58   Explicit( 0, 1 )     =   0.0;
59   Explicit( \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J}, \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} - 1 ) =   0.0;
60   Explicit( \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J}, \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} )     = - 1.0;
61 
62   \textcolor{comment}{// Initial condition u\_0(x) = 100 * sin( pi * x )}
63   \hyperlink{classLuna_1_1Vector}{Vector<double>} current( \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} + 1, 0.0 );
64   current[ 0 ] = 0.0;
65   solution( 0, 0, 0 ) = current[ 0 ];
66   \textcolor{keywordflow}{for} ( std::size\_t j = 1; j < \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J}; j++ )
67   \{
68     current[ j ] = 100 * sin( M\_PI * j * dx );
69     solution( j, 0, 0 ) = current[ j ];
70   \}
71   current[ \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} ] = 0.0;
72   solution( J, 0, 0 ) = current[ \hyperlink{namespaceHeat__plot_a3cafcec38d886f33b35756791964bb58}{J} ];
73 
74   \hyperlink{classLuna_1_1Vector}{Vector<double>} next( J + 1 );
75 
76   cout << \textcolor{stringliteral}{" * Calculating the solution..."} << endl;
77 
78   \textcolor{keywordflow}{for} ( std::size\_t i = 1; i < \hyperlink{namespaceHeat__plot_a7d050092798e28458a263710837bda77}{N} + 1; i++ )
79   \{
80     current = Explicit * current;
81     next = Implicit.solve( current );
82     current = next;
83     \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < J + 1; j++ )
84     \{
85       solution( j, i, 0 ) = current[ j ];
86     \}
87   \}
88   cout << \textcolor{stringliteral}{" * Solution complete."} << endl;
89 
90   \textcolor{keywordtype}{string} outstring( \textcolor{stringliteral}{"./DATA/Heat\_equation"} );
91   outstring += \textcolor{stringliteral}{"\_J\_"} + \hyperlink{namespaceLuna_1_1Utility_a7a21ee8e724765b7a018b6a5394b7e9c}{Utility::stringify}( J );
92   outstring += \textcolor{stringliteral}{"\_N\_"} + \hyperlink{namespaceLuna_1_1Utility_a7a21ee8e724765b7a018b6a5394b7e9c}{Utility::stringify}( N );
93   outstring += \textcolor{stringliteral}{".dat"};
94   solution.output( outstring );
95 
96   cout << \textcolor{stringliteral}{" * For an animation of the solution run:"} << endl;
97   cout << \textcolor{stringliteral}{"python Plotting/Heat\_plot.py "} << J << \textcolor{stringliteral}{" "} << N << endl;
98   cout << \textcolor{stringliteral}{"--- FINISHED ---"} << endl;
99 \}
\end{DoxyCode}
