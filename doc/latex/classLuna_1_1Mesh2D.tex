\hypertarget{classLuna_1_1Mesh2D}{}\section{Luna\+:\+:Mesh2D$<$ T $>$ Class Template Reference}
\label{classLuna_1_1Mesh2D}\index{Luna\+::\+Mesh2\+D$<$ T $>$@{Luna\+::\+Mesh2\+D$<$ T $>$}}


{\ttfamily \#include $<$Mesh2\+D.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classLuna_1_1Mesh2D_a867e2acbb4c6c23faf04ee6bacd2c300}{Mesh2D} ()
\begin{DoxyCompactList}\small\item\em Constructor for an empty mesh. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Mesh2D_ae0b525b986a67e18b0c413d304b011c1}{Mesh2D} (const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \&x\+\_\+nodes, const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \&y\+\_\+nodes, const std\+::size\+\_\+t \&nvars)
\begin{DoxyCompactList}\small\item\em Constructor (given nodal distribution) \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Mesh2D_a093b69eaccb8e9df54f3613a2f1027c0}{$\sim$\+Mesh2D} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
T \& \hyperlink{classLuna_1_1Mesh2D_ac12d7998f2cea2daeef921e738337a38}{operator()} (const std\+::size\+\_\+t nodex, const std\+::size\+\_\+t nodey, const std\+::size\+\_\+t var)
\begin{DoxyCompactList}\small\item\em Access operator for a nodal point/variable in the mesh. \end{DoxyCompactList}\item 
const T \& \hyperlink{classLuna_1_1Mesh2D_aff8f62c9cc1c67b973f9d3531bb94e9b}{operator()} (const std\+::size\+\_\+t nodex, const std\+::size\+\_\+t nodey, const std\+::size\+\_\+t var) const
\begin{DoxyCompactList}\small\item\em Const access operator for a nodal point/variable in the mesh. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Mesh2D}{Mesh2D}$<$ T $>$ \& \hyperlink{classLuna_1_1Mesh2D_a8bdd6247a49b7f148befc65937dfcc59}{operator=} (const \hyperlink{classLuna_1_1Mesh2D}{Mesh2D}$<$ T $>$ \&original)
\begin{DoxyCompactList}\small\item\em Copy assignment. \end{DoxyCompactList}\item 
std\+::pair$<$ double, double $>$ \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord} (const std\+::size\+\_\+t nodex, const std\+::size\+\_\+t nodey) const
\begin{DoxyCompactList}\small\item\em Return the spatial position of a given given node as a pair. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1Mesh2D_a40ceeeb39bb653c05a4b5c084e676e34}{set\+\_\+nodes\+\_\+vars} (const std\+::size\+\_\+t nodex, const std\+::size\+\_\+t nodey, const \hyperlink{classLuna_1_1Vector}{Vector}$<$ T $>$ \&vec)
\begin{DoxyCompactList}\small\item\em Set the variables stored at a specified node. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Vector}{Vector}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\+\_\+nodes\+\_\+vars} (const std\+::size\+\_\+t nodex, const std\+::size\+\_\+t nodey) const
\begin{DoxyCompactList}\small\item\em Get the variables stored at a specified node. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Mesh1D}{Mesh1D}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D_ac6745e18c235492110c0b6e3a9f94351}{get\+\_\+cross\+\_\+section\+\_\+xnode} (const std\+::size\+\_\+t nodex) const
\begin{DoxyCompactList}\small\item\em Get a cross section of the 2D mesh at a specified (constant) x node. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Mesh1D}{Mesh1D}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D_ad73c523ff66dc2d481370cd774c8e7e4}{get\+\_\+cross\+\_\+section\+\_\+ynode} (const std\+::size\+\_\+t nodey) const
\begin{DoxyCompactList}\small\item\em Get a cross section of the 2D mesh at a specified (constant) y node. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1Mesh2D_a4f0219cbe058c1610af4b358c384f3d2}{assign} (const T elt)
\begin{DoxyCompactList}\small\item\em Assign an element to all entries in the mesh. \end{DoxyCompactList}\item 
std\+::pair$<$ std\+::size\+\_\+t, std\+::size\+\_\+t $>$ \hyperlink{classLuna_1_1Mesh2D_a8e154c77471f89bc056b2950b26f1d80}{get\+\_\+nnodes} () const
\begin{DoxyCompactList}\small\item\em Get the number of nodes in the two directions of the 2D mesh. \end{DoxyCompactList}\item 
std\+::size\+\_\+t \hyperlink{classLuna_1_1Mesh2D_a4ba86ff35a1f11cd245505cc6eea013e}{get\+\_\+nvars} () const
\begin{DoxyCompactList}\small\item\em Get the number of variables that are stored at each node. \end{DoxyCompactList}\item 
const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \& \hyperlink{classLuna_1_1Mesh2D_a8a860fec0e116f915dcac68476d9e7d8}{xnodes} () const
\begin{DoxyCompactList}\small\item\em Return A vector of the x-\/nodal positions for this mesh. \end{DoxyCompactList}\item 
const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \& \hyperlink{classLuna_1_1Mesh2D_a7644446cbd5b3f1dc40f1fd8f9137ff3}{ynodes} () const
\begin{DoxyCompactList}\small\item\em Return A vector of the y-\/nodal positions for this mesh. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Matrix}{Matrix}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D_a5a1fead4879bad7bd798cac3bfd10e85}{get\+\_\+var\+\_\+as\+\_\+matrix} (std\+::size\+\_\+t var) const
\begin{DoxyCompactList}\small\item\em Return a \hyperlink{classLuna_1_1Matrix}{Matrix} corresponding to each nodal point in the mesh. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1Mesh2D_a3874356b327d21ac65b16d181a4240f3}{remesh} (const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \&newX, const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \&newY)
\begin{DoxyCompactList}\small\item\em Interpolate the mesh data (bilinearly) into a new mesh. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1Mesh2D_a904628aa8c8e0b4ca4a0d794f52c8899}{output} () const
\begin{DoxyCompactList}\small\item\em Output mesh data to std\+::cout. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1Mesh2D_a02037bbd93a09db9c772528c4a4e8bf3}{output} (std\+::string filename) const
\begin{DoxyCompactList}\small\item\em Output mesh data to a file. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1Mesh2D_ab5fe26bc77435039388362aeab903313}{output\+\_\+var} (std\+::string filename, const std\+::size\+\_\+t var) const
\begin{DoxyCompactList}\small\item\em Output a single variable to a file with no nodal information. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1Mesh2D_a21825e991e96d5cfad2dc9de68cf5f73}{read} (std\+::string filename, const bool reset=false)
\begin{DoxyCompactList}\small\item\em A simple method for reading data from a file. \end{DoxyCompactList}\item 
void \hyperlink{classLuna_1_1Mesh2D_a8fc9046e860764d5069c4e9b8667df1f}{output\+\_\+gnu} (std\+::string filename) const
\begin{DoxyCompactList}\small\item\em Output data to a file for gnuplot surface plotting. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Vector}{Vector}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D_aac2ab4028e87cb380f7e23a81e5c5c6e}{get\+\_\+interpolated\+\_\+vars} (const double \&x, const double \&\hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y})
\begin{DoxyCompactList}\small\item\em Get a bilinearly interpolated value at a specified point. \end{DoxyCompactList}\item 
T \hyperlink{classLuna_1_1Mesh2D_a32772d3c7093a5e3c1919e589ccdd810}{integral2D} (std\+::size\+\_\+t var=0) const
\begin{DoxyCompactList}\small\item\em Numerically integrate a given variable over the domain. \end{DoxyCompactList}\item 
T \hyperlink{classLuna_1_1Mesh2D_a41e9d12ae3f05af7a12cd05690fff29c}{square\+\_\+integral2D} (std\+::size\+\_\+t var=0) const
\begin{DoxyCompactList}\small\item\em Numerically integrate the square of the absolute value over the domain. \end{DoxyCompactList}\item 
\hyperlink{classLuna_1_1Vector}{Vector}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D_a6c01996a6cafd29b513811de33fd323c}{get\+\_\+vars} ()
\begin{DoxyCompactList}\small\item\em Return the \hyperlink{classLuna_1_1Vector}{Vector} of variables. \end{DoxyCompactList}\item 
{\footnotesize template$<$$>$ }\\void \hyperlink{classLuna_1_1Mesh2D_acf187c6339ea8527fa70f2d5e74abe41}{read} (std\+::string filename, const bool reset)
\item 
{\footnotesize template$<$$>$ }\\void \hyperlink{classLuna_1_1Mesh2D_ab5cffc3cb5b8424b11154cb35b98dbf3}{output\+\_\+gnu} (std\+::string filename) const
\item 
{\footnotesize template$<$$>$ }\\void \hyperlink{classLuna_1_1Mesh2D_a4b2240afef17ec91c1d926bb56e1f92f}{output\+\_\+gnu} (std\+::string filename) const
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$class T$>$\newline
class Luna\+::\+Mesh2\+D$<$ T $>$}



Definition at line 26 of file Mesh2\+D.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a867e2acbb4c6c23faf04ee6bacd2c300}\label{classLuna_1_1Mesh2D_a867e2acbb4c6c23faf04ee6bacd2c300}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!Mesh2D@{Mesh2D}}
\index{Mesh2D@{Mesh2D}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{Mesh2\+D()}{Mesh2D()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class T$>$ \\
\hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::\hyperlink{classLuna_1_1Mesh2D}{Mesh2D} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor for an empty mesh. 



Definition at line 37 of file Mesh2\+D.\+h.


\begin{DoxyCode}
37              : NX( 0 ), NY( 0 ), NV( 0 )
38     \{\}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_ae0b525b986a67e18b0c413d304b011c1}\label{classLuna_1_1Mesh2D_ae0b525b986a67e18b0c413d304b011c1}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!Mesh2D@{Mesh2D}}
\index{Mesh2D@{Mesh2D}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{Mesh2\+D()}{Mesh2D()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$class T$>$ \\
\hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::\hyperlink{classLuna_1_1Mesh2D}{Mesh2D} (\begin{DoxyParamCaption}\item[{const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \&}]{x\+\_\+nodes,  }\item[{const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \&}]{y\+\_\+nodes,  }\item[{const std\+::size\+\_\+t \&}]{nvars }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor (given nodal distribution) 


\begin{DoxyParams}{Parameters}
{\em x\+\_\+nodes} & \hyperlink{classLuna_1_1Vector}{Vector} of nodal positions along the x-\/axis \\
\hline
{\em y\+\_\+nodes} & \hyperlink{classLuna_1_1Vector}{Vector} of nodal positions along the y-\/axis \\
\hline
{\em nvars} & The number of variables \\
\hline
\end{DoxyParams}


Definition at line 44 of file Mesh2\+D.\+h.


\begin{DoxyCode}
45                                      : NX( x\_nodes.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() ),
46             NY( y\_nodes.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() ), NV( nvars ), X\_NODES( x\_nodes ),
47             Y\_NODES( y\_nodes )
48     \{
49       \textcolor{comment}{// Create the storage Vector and set the contents to zero}
50       VARS = Vector<T>( NV * NX * NY, T( 0.0 ) );
51     \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a093b69eaccb8e9df54f3613a2f1027c0}\label{classLuna_1_1Mesh2D_a093b69eaccb8e9df54f3613a2f1027c0}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!````~Mesh2D@{$\sim$\+Mesh2D}}
\index{````~Mesh2D@{$\sim$\+Mesh2D}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{$\sim$\+Mesh2\+D()}{~Mesh2D()}}
{\footnotesize\ttfamily template$<$class T$>$ \\
\hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::$\sim$\hyperlink{classLuna_1_1Mesh2D}{Mesh2D} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Destructor. 



Definition at line 54 of file Mesh2\+D.\+h.



References Luna\+::\+Mesh2\+D$<$ T $>$\+::assign(), Luna\+::\+Mesh2\+D$<$ T $>$\+::coord(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+cross\+\_\+section\+\_\+xnode(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+cross\+\_\+section\+\_\+ynode(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+interpolated\+\_\+vars(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+nnodes(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+nodes\+\_\+vars(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+nvars(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+var\+\_\+as\+\_\+matrix(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+vars(), Luna\+::\+Mesh2\+D$<$ T $>$\+::integral2\+D(), Luna\+::\+Mesh2\+D$<$ T $>$\+::operator()(), Luna\+::\+Mesh2\+D$<$ T $>$\+::operator=(), Luna\+::\+Mesh2\+D$<$ T $>$\+::output(), Luna\+::\+Mesh2\+D$<$ T $>$\+::output\+\_\+gnu(), Luna\+::\+Mesh2\+D$<$ T $>$\+::output\+\_\+var(), Luna\+::\+Mesh2\+D$<$ T $>$\+::read(), Luna\+::\+Mesh2\+D$<$ T $>$\+::remesh(), Luna\+::\+Mesh2\+D$<$ T $>$\+::set\+\_\+nodes\+\_\+vars(), Luna\+::\+Mesh2\+D$<$ T $>$\+::square\+\_\+integral2\+D(), Heat\+\_\+plot\+::x, Luna\+::\+Mesh2\+D$<$ T $>$\+::xnodes(), y, and Luna\+::\+Mesh2\+D$<$ T $>$\+::ynodes().


\begin{DoxyCode}
54 \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a4f0219cbe058c1610af4b358c384f3d2}\label{classLuna_1_1Mesh2D_a4f0219cbe058c1610af4b358c384f3d2}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!assign@{assign}}
\index{assign@{assign}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{assign()}{assign()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::assign (\begin{DoxyParamCaption}\item[{const T}]{elt }\end{DoxyParamCaption})}



Assign an element to all entries in the mesh. 


\begin{DoxyParams}{Parameters}
{\em elt} & Element to assign to all entries in the mesh \\
\hline
\end{DoxyParams}


Definition at line 329 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
330   \{
331     VARS.assign( NX * NY * NV, elt );
332   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}\label{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!coord@{coord}}
\index{coord@{coord}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{coord()}{coord()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
std\+::pair$<$ double, double $>$ \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::coord (\begin{DoxyParamCaption}\item[{const std\+::size\+\_\+t}]{nodex,  }\item[{const std\+::size\+\_\+t}]{nodey }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the spatial position of a given given node as a pair. 


\begin{DoxyParams}{Parameters}
{\em nodex} & Node index ( x-\/axis ) \\
\hline
{\em nodey} & Node index ( y-\/axis ) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The nodal value pair at the specified index 
\end{DoxyReturn}


Definition at line 243 of file Mesh2\+D.\+h.



Referenced by main(), Luna\+::\+Mesh2\+D$<$ T $>$\+::remesh(), and Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
245   \{
246     \textcolor{keywordflow}{if} ( nodex > NX - 1 || nodey > NY - 1 || nodex < 0 || nodey < 0 )
247     \{
248       std::string problem;
249       problem = \textcolor{stringliteral}{" The Mesh2D.coord method is trying to \(\backslash\)n"};
250       problem += \textcolor{stringliteral}{" access a nodal point that is not in the mesh. \(\backslash\)n"};
251       \textcolor{keywordflow}{throw} Error( problem );
252     \}
253     std::pair< double, double > pos;
254     pos.first = X\_NODES[ nodex ];
255     pos.second = Y\_NODES[ nodey ];
256     \textcolor{keywordflow}{return} pos;
257   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_ac6745e18c235492110c0b6e3a9f94351}\label{classLuna_1_1Mesh2D_ac6745e18c235492110c0b6e3a9f94351}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!get\+\_\+cross\+\_\+section\+\_\+xnode@{get\+\_\+cross\+\_\+section\+\_\+xnode}}
\index{get\+\_\+cross\+\_\+section\+\_\+xnode@{get\+\_\+cross\+\_\+section\+\_\+xnode}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{get\+\_\+cross\+\_\+section\+\_\+xnode()}{get\_cross\_section\_xnode()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\hyperlink{classLuna_1_1Mesh1D}{Mesh1D}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::get\+\_\+cross\+\_\+section\+\_\+xnode (\begin{DoxyParamCaption}\item[{const std\+::size\+\_\+t}]{nodex }\end{DoxyParamCaption}) const}



Get a cross section of the 2D mesh at a specified (constant) x node. 


\begin{DoxyParams}{Parameters}
{\em nodex} & Node index ( x-\/axis ) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A 1D mesh cross section of the 2D mesh 
\end{DoxyReturn}


Definition at line 307 of file Mesh2\+D.\+h.



References Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+nodes\+\_\+vars(), and Luna\+::\+Mesh1\+D$<$ T, X $>$\+::set\+\_\+nodes\+\_\+vars().



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
308   \{
309     Mesh1D<T> section( Y\_NODES, NV );
310     \textcolor{keywordflow}{for} ( std::size\_t nodey = 0; nodey < NY; ++nodey )
311     \{
312       section.set\_nodes\_vars( nodey, \textcolor{keyword}{this} -> \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( nodex, nodey ) );
313     \}
314     \textcolor{keywordflow}{return} section;
315   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_ad73c523ff66dc2d481370cd774c8e7e4}\label{classLuna_1_1Mesh2D_ad73c523ff66dc2d481370cd774c8e7e4}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!get\+\_\+cross\+\_\+section\+\_\+ynode@{get\+\_\+cross\+\_\+section\+\_\+ynode}}
\index{get\+\_\+cross\+\_\+section\+\_\+ynode@{get\+\_\+cross\+\_\+section\+\_\+ynode}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{get\+\_\+cross\+\_\+section\+\_\+ynode()}{get\_cross\_section\_ynode()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\hyperlink{classLuna_1_1Mesh1D}{Mesh1D}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::get\+\_\+cross\+\_\+section\+\_\+ynode (\begin{DoxyParamCaption}\item[{const std\+::size\+\_\+t}]{nodey }\end{DoxyParamCaption}) const}



Get a cross section of the 2D mesh at a specified (constant) y node. 


\begin{DoxyParams}{Parameters}
{\em nodey} & Node index ( y-\/axis ) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A 1D mesh cross section of the 2D mesh 
\end{DoxyReturn}


Definition at line 318 of file Mesh2\+D.\+h.



References Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+nodes\+\_\+vars(), and Luna\+::\+Mesh1\+D$<$ T, X $>$\+::set\+\_\+nodes\+\_\+vars().



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+interpolated\+\_\+vars(), and Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
319   \{
320     Mesh1D<T> section( X\_NODES, NV );
321     \textcolor{keywordflow}{for} ( std::size\_t nodex = 0; nodex < NX; ++nodex )
322     \{
323       section.set\_nodes\_vars( nodex, \textcolor{keyword}{this} -> \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( nodex, nodey ) );
324     \}
325     \textcolor{keywordflow}{return} section;
326   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_aac2ab4028e87cb380f7e23a81e5c5c6e}\label{classLuna_1_1Mesh2D_aac2ab4028e87cb380f7e23a81e5c5c6e}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!get\+\_\+interpolated\+\_\+vars@{get\+\_\+interpolated\+\_\+vars}}
\index{get\+\_\+interpolated\+\_\+vars@{get\+\_\+interpolated\+\_\+vars}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{get\+\_\+interpolated\+\_\+vars()}{get\_interpolated\_vars()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\hyperlink{classLuna_1_1Vector}{Vector}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::get\+\_\+interpolated\+\_\+vars (\begin{DoxyParamCaption}\item[{const double \&}]{x,  }\item[{const double \&}]{y }\end{DoxyParamCaption})}



Get a bilinearly interpolated value at a specified point. 


\begin{DoxyParams}{Parameters}
{\em x} & The x-\/coordinate \\
\hline
{\em y} & The y-\/coordinate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The interpolated \hyperlink{classLuna_1_1Vector}{Vector} of variables at a specified point 
\end{DoxyReturn}


Definition at line 831 of file Mesh2\+D.\+h.



References Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+cross\+\_\+section\+\_\+ynode(), Luna\+::\+Mesh1\+D$<$ T, X $>$\+::get\+\_\+interpolated\+\_\+vars(), and y.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
832   \{
833     \textcolor{keywordflow}{if} ( ( \hyperlink{namespaceHeat__plot_aa88370c16b85b784ccbde3ed88bc1991}{x} < X\_NODES[ 0 ] ) || ( \hyperlink{namespaceHeat__plot_aa88370c16b85b784ccbde3ed88bc1991}{x} > X\_NODES[ NX - 1 ] ) )
834     \{
835       std::string problem;
836       problem = \textcolor{stringliteral}{"The Mesh2D.get\_interpolated\_vars method has been called \(\backslash\)n"};
837       problem += \textcolor{stringliteral}{"with an x coordinate that lies outside the mesh. \(\backslash\)n"};
838       \textcolor{keywordflow}{throw} Error( problem );
839     \}
840     \textcolor{keywordflow}{if} ( ( \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} < Y\_NODES[ 0 ] ) || ( \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} > Y\_NODES[ NY - 1 ] ) )
841     \{
842       std::string problem;
843       problem = \textcolor{stringliteral}{"The Mesh2D.get\_interpolated\_vars method has been called \(\backslash\)n"};
844       problem += \textcolor{stringliteral}{"with a y coordinate that lies outside the mesh. \(\backslash\)n"};
845       \textcolor{keywordflow}{throw} Error( problem );
846     \}
847     \textcolor{keywordtype}{int} bottom\_j( -2 );
848     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} j = 0; j < NY - 1; ++j )
849     \{
850       \textcolor{keywordflow}{if} ( ( \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} > Y\_NODES[ j ] ) && ( \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} < Y\_NODES[ j + 1 ] ) )
851       \{
852         bottom\_j = j;
853       \}
854       \textcolor{keywordflow}{if} ( ( abs( \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} - Y\_NODES[ j ] ) < 1.e-10 ) ||
855            ( abs( \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} - Y\_NODES[ j + 1 ] ) < 1.e-10 ) )
856       \{
857         bottom\_j = j;
858       \}
859     \}
860     \textcolor{keywordflow}{if} ( bottom\_j == -1 )
861     \{
862       std::string problem;
863       problem = \textcolor{stringliteral}{" The Mesh2D.get\_interpolated\_vars method is broken.\(\backslash\)n"};
864       \textcolor{keywordflow}{throw} Error( problem );
865     \}
866 
867     \textcolor{comment}{//std::cout << y << " " << Y\_NODES[bottom\_j] << " "}
868     \textcolor{comment}{//          << Y\_NODES[bottom\_j+1] << "\(\backslash\)n";}
869 
870     Mesh1D<T> bottom\_row = \hyperlink{classLuna_1_1Mesh2D_ad73c523ff66dc2d481370cd774c8e7e4}{get\_cross\_section\_ynode}( bottom\_j );
871     Mesh1D<T> top\_row = \hyperlink{classLuna_1_1Mesh2D_ad73c523ff66dc2d481370cd774c8e7e4}{get\_cross\_section\_ynode}( bottom\_j + 1 );
872     \textcolor{keyword}{const} \textcolor{keywordtype}{double} y1 = Y\_NODES[ bottom\_j ];
873     \textcolor{keyword}{const} \textcolor{keywordtype}{double} y2 = Y\_NODES[ bottom\_j + 1 ];
874     Vector<T> result = top\_row.get\_interpolated\_vars( \hyperlink{namespaceHeat__plot_aa88370c16b85b784ccbde3ed88bc1991}{x} )*( y2-\hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y} )/( y2-y1 )
875       + bottom\_row.get\_interpolated\_vars(\hyperlink{namespaceHeat__plot_aa88370c16b85b784ccbde3ed88bc1991}{x})*( \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y}-y1 )/( y2-y1 );
876     \textcolor{comment}{//std::cout << "x,y,interp: " << x << " " << y << " " << result[0] << "\(\backslash\)n";}
877     \textcolor{keywordflow}{return} result;
878   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a8e154c77471f89bc056b2950b26f1d80}\label{classLuna_1_1Mesh2D_a8e154c77471f89bc056b2950b26f1d80}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!get\+\_\+nnodes@{get\+\_\+nnodes}}
\index{get\+\_\+nnodes@{get\+\_\+nnodes}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{get\+\_\+nnodes()}{get\_nnodes()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
std\+::pair$<$ std\+::size\+\_\+t, std\+::size\+\_\+t $>$ \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::get\+\_\+nnodes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Get the number of nodes in the two directions of the 2D mesh. 

\begin{DoxyReturn}{Returns}
A std\+::pair containing the number of nodes in each direction 
\end{DoxyReturn}


Definition at line 335 of file Mesh2\+D.\+h.



Referenced by main(), and Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
336   \{
337     std::pair< std::size\_t, std::size\_t > nodes;
338     nodes.first = NX;
339     nodes.second = NY;
340     \textcolor{keywordflow}{return} nodes;
341   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}\label{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!get\+\_\+nodes\+\_\+vars@{get\+\_\+nodes\+\_\+vars}}
\index{get\+\_\+nodes\+\_\+vars@{get\+\_\+nodes\+\_\+vars}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{get\+\_\+nodes\+\_\+vars()}{get\_nodes\_vars()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\hyperlink{classLuna_1_1Vector}{Vector}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::get\+\_\+nodes\+\_\+vars (\begin{DoxyParamCaption}\item[{const std\+::size\+\_\+t}]{nodex,  }\item[{const std\+::size\+\_\+t}]{nodey }\end{DoxyParamCaption}) const}



Get the variables stored at a specified node. 


\begin{DoxyParams}{Parameters}
{\em nodex} & Node index ( x-\/axis ) \\
\hline
{\em nodey} & Node index ( y-\/axis ) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The \hyperlink{classLuna_1_1Vector}{Vector} of variables 
\end{DoxyReturn}


Definition at line 287 of file Mesh2\+D.\+h.



References Luna\+::\+Vector$<$ T $>$\+::push\+\_\+back().



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+cross\+\_\+section\+\_\+xnode(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+cross\+\_\+section\+\_\+ynode(), Luna\+::\+Mesh2\+D$<$ T $>$\+::remesh(), and Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
289   \{
290     \textcolor{keywordflow}{if} ( nodex > NX - 1 || nodey > NY - 1 )
291     \{
292       std::string problem;
293       problem = \textcolor{stringliteral}{" The Mesh2D.get\_nodes\_vars method is trying to \(\backslash\)n"};
294       problem += \textcolor{stringliteral}{" access a nodal point that is not in the mesh. \(\backslash\)n"};
295       \textcolor{keywordflow}{throw} Error( problem );
296     \}
297     \textcolor{comment}{//Construct a vector with NV elements}
298     Vector<T> nodes\_vars;
299     \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
300     \{
301       nodes\_vars.push\_back( VARS[ ( nodex * NY + nodey ) * NV + var ] );
302     \}
303     \textcolor{keywordflow}{return} nodes\_vars;
304   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a4ba86ff35a1f11cd245505cc6eea013e}\label{classLuna_1_1Mesh2D_a4ba86ff35a1f11cd245505cc6eea013e}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!get\+\_\+nvars@{get\+\_\+nvars}}
\index{get\+\_\+nvars@{get\+\_\+nvars}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{get\+\_\+nvars()}{get\_nvars()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
std\+::size\+\_\+t \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::get\+\_\+nvars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Get the number of variables that are stored at each node. 

\begin{DoxyReturn}{Returns}
The number of variables stored in the mesh 
\end{DoxyReturn}


Definition at line 344 of file Mesh2\+D.\+h.



Referenced by main(), and Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
345   \{
346     \textcolor{keywordflow}{return} NV;
347   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a5a1fead4879bad7bd798cac3bfd10e85}\label{classLuna_1_1Mesh2D_a5a1fead4879bad7bd798cac3bfd10e85}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!get\+\_\+var\+\_\+as\+\_\+matrix@{get\+\_\+var\+\_\+as\+\_\+matrix}}
\index{get\+\_\+var\+\_\+as\+\_\+matrix@{get\+\_\+var\+\_\+as\+\_\+matrix}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{get\+\_\+var\+\_\+as\+\_\+matrix()}{get\_var\_as\_matrix()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\hyperlink{classLuna_1_1Matrix}{Matrix}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::get\+\_\+var\+\_\+as\+\_\+matrix (\begin{DoxyParamCaption}\item[{std\+::size\+\_\+t}]{var }\end{DoxyParamCaption}) const}



Return a \hyperlink{classLuna_1_1Matrix}{Matrix} corresponding to each nodal point in the mesh. 


\begin{DoxyParams}{Parameters}
{\em var} & Variable index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A \hyperlink{classLuna_1_1Matrix}{Matrix} for a specified variable at each nodal point 
\end{DoxyReturn}


Definition at line 362 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
363   \{
364     \textcolor{keywordflow}{if} ( var > NV - 1 )
365     \{
366       std::string problem;
367       problem = \textcolor{stringliteral}{" The Mesh2D.get\_var\_as\_matrix method is trying to use an \(\backslash\)n"};
368       problem += \textcolor{stringliteral}{" index bigger than the number of variables in the mesh. \(\backslash\)n"};
369       \textcolor{keywordflow}{throw} Error( problem );
370     \}
371     Matrix<T> temp( NX, NY, 0.0 );
372     \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < NX; ++i )
373     \{
374       \textcolor{keywordflow}{for}  ( std::size\_t j = 0; j < NY; ++j )
375       \{
376         temp( i, j ) = VARS[ ( i * NY + j ) * NV + var ];
377       \}
378     \}
379     \textcolor{keywordflow}{return} temp;
380   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a6c01996a6cafd29b513811de33fd323c}\label{classLuna_1_1Mesh2D_a6c01996a6cafd29b513811de33fd323c}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!get\+\_\+vars@{get\+\_\+vars}}
\index{get\+\_\+vars@{get\+\_\+vars}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{get\+\_\+vars()}{get\_vars()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\hyperlink{classLuna_1_1Vector}{Vector}$<$ T $>$ \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::get\+\_\+vars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Return the \hyperlink{classLuna_1_1Vector}{Vector} of variables. 

\begin{DoxyReturn}{Returns}
A copy of the \hyperlink{classLuna_1_1Vector}{Vector} of variables 
\end{DoxyReturn}


Definition at line 927 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
928   \{
929     Vector<T> temp;
930     temp = VARS;
931     \textcolor{keywordflow}{return} temp;
932   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a32772d3c7093a5e3c1919e589ccdd810}\label{classLuna_1_1Mesh2D_a32772d3c7093a5e3c1919e589ccdd810}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!integral2D@{integral2D}}
\index{integral2D@{integral2D}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{integral2\+D()}{integral2D()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
T \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::integral2D (\begin{DoxyParamCaption}\item[{std\+::size\+\_\+t}]{var = {\ttfamily 0} }\end{DoxyParamCaption}) const}



Numerically integrate a given variable over the domain. 


\begin{DoxyParams}{Parameters}
{\em var} & Variable index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The integral over the domain 
\end{DoxyReturn}


Definition at line 881 of file Mesh2\+D.\+h.



Referenced by main(), and Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
882   \{
883     T sum( 0.0 );
884     \textcolor{keywordtype}{double} dx( 0.0 );
885     \textcolor{keywordtype}{double} dy( 0.0 );
886     \textcolor{comment}{// Sum over the elements}
887     \textcolor{keywordflow}{for} ( std::size\_t i=0; i < NX - 1; ++i )
888     \{
889       dx = X\_NODES[ i + 1 ] - X\_NODES[ i ];
890       \textcolor{keywordflow}{for} ( std::size\_t j=0; j < NY - 1; ++j )
891       \{
892         dy = Y\_NODES[ j + 1 ] - Y\_NODES[ j ];
893         sum += 0.25 * dx * dy * ( VARS[ ( i * NY + j ) * NV + var ]
894             + VARS[ ( ( i + 1 ) * NY + j ) * NV + var ]
895             + VARS[ ( i * NY + j + 1 ) * NV + var ]
896             + VARS[ ( ( i + 1 ) * NY + j + 1 ) * NV + var ] );
897       \}
898     \}
899     \textcolor{keywordflow}{return} sum;
900   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_ac12d7998f2cea2daeef921e738337a38}\label{classLuna_1_1Mesh2D_ac12d7998f2cea2daeef921e738337a38}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!operator()@{operator()}}
\index{operator()@{operator()}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{operator()()}{operator()()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
T \& \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::operator() (\begin{DoxyParamCaption}\item[{const std\+::size\+\_\+t}]{nodex,  }\item[{const std\+::size\+\_\+t}]{nodey,  }\item[{const std\+::size\+\_\+t}]{var }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Access operator for a nodal point/variable in the mesh. 


\begin{DoxyParams}{Parameters}
{\em nodex} & Node index ( x-\/axis ) \\
\hline
{\em nodey} & Node index ( y-\/axis ) \\
\hline
{\em var} & Variable index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A reference to the variable stored at the given node 
\end{DoxyReturn}


Definition at line 186 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
189   \{
190     \textcolor{keywordflow}{if} ( nodex > NX - 1 || nodey > NY - 1 )
191     \{
192       std::string problem;
193       problem = \textcolor{stringliteral}{" The Mesh2D.operator() method is trying to \(\backslash\)n"};
194       problem += \textcolor{stringliteral}{" access a nodal point that is not in the mesh. \(\backslash\)n"};
195       \textcolor{keywordflow}{throw} Error( problem );
196     \}
197     \textcolor{keywordflow}{if} ( var > NV - 1 )
198     \{
199       std::string problem;
200       problem = \textcolor{stringliteral}{" The Mesh2D.operator() method is trying to \(\backslash\)n"};
201       problem += \textcolor{stringliteral}{" access a variable index that is not in the mesh. \(\backslash\)n"};
202       \textcolor{keywordflow}{throw} Error( problem );
203     \}
204 
205     \textcolor{keywordflow}{return} VARS[ ( nodex * NY + nodey ) * NV + var ];
206   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_aff8f62c9cc1c67b973f9d3531bb94e9b}\label{classLuna_1_1Mesh2D_aff8f62c9cc1c67b973f9d3531bb94e9b}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!operator()@{operator()}}
\index{operator()@{operator()}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{operator()()}{operator()()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
const T \& \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::operator() (\begin{DoxyParamCaption}\item[{const std\+::size\+\_\+t}]{nodex,  }\item[{const std\+::size\+\_\+t}]{nodey,  }\item[{const std\+::size\+\_\+t}]{var }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Const access operator for a nodal point/variable in the mesh. 


\begin{DoxyParams}{Parameters}
{\em nodex} & Node index ( x-\/axis ) \\
\hline
{\em nodey} & Node index ( y-\/axis ) \\
\hline
{\em var} & Variable index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A constant reference to the variable stored at the given node 
\end{DoxyReturn}


Definition at line 209 of file Mesh2\+D.\+h.


\begin{DoxyCode}
212   \{
213     \textcolor{keywordflow}{if} ( nodex > NX - 1 || nodey > NY - 1 )
214     \{
215       std::string problem;
216       problem = \textcolor{stringliteral}{" The Mesh2D.operator() method is trying to \(\backslash\)n"};
217       problem += \textcolor{stringliteral}{" access a nodal point that is not in the mesh. \(\backslash\)n"};
218       \textcolor{keywordflow}{throw} Error( problem );
219     \}
220     \textcolor{keywordflow}{if} ( var > NV - 1 )
221     \{
222       std::string problem;
223       problem = \textcolor{stringliteral}{" The Mesh2D.operator() method is trying to \(\backslash\)n"};
224       problem += \textcolor{stringliteral}{" access a variable index that is not in the mesh. \(\backslash\)n"};
225       \textcolor{keywordflow}{throw} Error( problem );
226     \}
227     \textcolor{keywordflow}{return} VARS[ ( nodex * NY + nodey ) * NV + var ];
228   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a8bdd6247a49b7f148befc65937dfcc59}\label{classLuna_1_1Mesh2D_a8bdd6247a49b7f148befc65937dfcc59}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!operator=@{operator=}}
\index{operator=@{operator=}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\hyperlink{classLuna_1_1Mesh2D}{Mesh2D}$<$ T $>$ \& \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classLuna_1_1Mesh2D}{Mesh2D}$<$ T $>$ \&}]{original }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Copy assignment. 


\begin{DoxyParams}{Parameters}
{\em original} & 2D mesh to be copied \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The new 2D mesh 
\end{DoxyReturn}


Definition at line 231 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
232   \{
233     NX = original.NX;
234     NY = original.NY;
235     NV = original.NV;
236     X\_NODES = original.X\_NODES;
237     Y\_NODES =  original.Y\_NODES;
238     VARS = original.VARS;
239     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
240   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a904628aa8c8e0b4ca4a0d794f52c8899}\label{classLuna_1_1Mesh2D_a904628aa8c8e0b4ca4a0d794f52c8899}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!output@{output}}
\index{output@{output}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{output()}{output()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Output mesh data to std\+::cout. 



Definition at line 655 of file Mesh2\+D.\+h.



Referenced by main(), and Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
656   \{
657     \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
658     \{
659       std::cout << \textcolor{stringliteral}{"Variable : "} << var << \textcolor{stringliteral}{"\(\backslash\)n"};
660       std::cout << \textcolor{stringliteral}{" x = "};
661       \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < NX; ++i )
662       \{
663         std::cout << X\_NODES[ i ] << \textcolor{stringliteral}{", "};
664       \}
665       std::cout << \textcolor{stringliteral}{"\(\backslash\)n"};
666       \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < NY; ++j )
667       \{
668         std::cout << \textcolor{stringliteral}{" y = "} << Y\_NODES[ j ] << \textcolor{stringliteral}{"\(\backslash\)n"};
669         \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < NX; ++i )
670         \{
671           std::cout << VARS[ ( i * NY + j ) * NV + var ] << \textcolor{stringliteral}{", "};
672         \}
673         std::cout << \textcolor{stringliteral}{"\(\backslash\)n"};
674       \}
675     \}
676   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a02037bbd93a09db9c772528c4a4e8bf3}\label{classLuna_1_1Mesh2D_a02037bbd93a09db9c772528c4a4e8bf3}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!output@{output}}
\index{output@{output}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{output()}{output()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::output (\begin{DoxyParamCaption}\item[{std\+::string}]{filename }\end{DoxyParamCaption}) const}



Output mesh data to a file. 


\begin{DoxyParams}{Parameters}
{\em filename} & Name of the file to output the mesh data to \\
\hline
\end{DoxyParams}


Definition at line 679 of file Mesh2\+D.\+h.


\begin{DoxyCode}
680   \{
681     std::ofstream out;
682     out.open( filename.c\_str() );
683     out.precision( 12 );
684     out.setf( std::ios::showpoint );
685     out.setf( std::ios::showpos );
686     out.setf( std::ios::scientific );
687     out.precision( 12 );
688     \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < NY; ++j )
689     \{
690       \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < NX; ++i )
691       \{
692         out << X\_NODES[ i ] << \textcolor{stringliteral}{" "} << Y\_NODES[ j ] << \textcolor{stringliteral}{" "};
693         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
694         \{
695           out << VARS[ ( i * NY + j ) * NV + var ] << \textcolor{stringliteral}{" "};
696         \}
697         out << \textcolor{stringliteral}{"\(\backslash\)n"};
698       \}
699       out << \textcolor{stringliteral}{"\(\backslash\)n"};
700     \}
701   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a8fc9046e860764d5069c4e9b8667df1f}\label{classLuna_1_1Mesh2D_a8fc9046e860764d5069c4e9b8667df1f}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!output\+\_\+gnu@{output\+\_\+gnu}}
\index{output\+\_\+gnu@{output\+\_\+gnu}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{output\+\_\+gnu()}{output\_gnu()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template$<$class T$>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::output\+\_\+gnu (\begin{DoxyParamCaption}\item[{std\+::string}]{filename }\end{DoxyParamCaption}) const}



Output data to a file for gnuplot surface plotting. 


\begin{DoxyParams}{Parameters}
{\em filename} & Name of the file to output the mesh data to \\
\hline
\end{DoxyParams}


Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().

\mbox{\Hypertarget{classLuna_1_1Mesh2D_ab5cffc3cb5b8424b11154cb35b98dbf3}\label{classLuna_1_1Mesh2D_ab5cffc3cb5b8424b11154cb35b98dbf3}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!output\+\_\+gnu@{output\+\_\+gnu}}
\index{output\+\_\+gnu@{output\+\_\+gnu}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{output\+\_\+gnu()}{output\_gnu()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template$<$$>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ double $>$\+::output\+\_\+gnu (\begin{DoxyParamCaption}\item[{std\+::string}]{filename }\end{DoxyParamCaption}) const}



Definition at line 778 of file Mesh2\+D.\+h.


\begin{DoxyCode}
779   \{
780     std::ofstream out;
781     out.open( filename.c\_str() );
782     out.precision( 12 );
783     out.setf( std::ios::showpoint );
784     out.setf( std::ios::showpos );
785     out.setf( std::ios::scientific );
786 
787     \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < NX; ++i )
788     \{
789       \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < NY; ++j )
790       \{
791         out << X\_NODES[ i ] << \textcolor{stringliteral}{" "} << Y\_NODES[ j ] << \textcolor{stringliteral}{" "};
792         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
793         \{
794           out << VARS[ ( i * NY + j ) * NV + var ] << \textcolor{stringliteral}{" "};
795         \}
796         out << \textcolor{stringliteral}{"\(\backslash\)n"};
797       \}
798       out << \textcolor{stringliteral}{"\(\backslash\)n"};
799     \}
800     out.close();
801   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a4b2240afef17ec91c1d926bb56e1f92f}\label{classLuna_1_1Mesh2D_a4b2240afef17ec91c1d926bb56e1f92f}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!output\+\_\+gnu@{output\+\_\+gnu}}
\index{output\+\_\+gnu@{output\+\_\+gnu}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{output\+\_\+gnu()}{output\_gnu()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$$>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ std\+::complex$<$ double $>$ $>$\+::output\+\_\+gnu (\begin{DoxyParamCaption}\item[{std\+::string}]{filename }\end{DoxyParamCaption}) const}



Definition at line 804 of file Mesh2\+D.\+h.


\begin{DoxyCode}
805   \{
806     std::ofstream out;
807     out.open( filename.c\_str() );
808     out.precision( 12 );
809     out.setf( std::ios::showpoint );
810     out.setf( std::ios::showpos );
811     out.setf( std::ios::scientific );
812     \textcolor{comment}{//}
813     \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < NX; ++i )
814     \{
815       \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < NY; ++j )
816       \{
817         out << X\_NODES[ i ] << \textcolor{stringliteral}{" "} << Y\_NODES[ j ] << \textcolor{stringliteral}{" "};
818         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
819         \{
820           out << real(VARS[ ( i * NY + j ) * NV + var ]) << \textcolor{stringliteral}{" "};
821           out << imag(VARS[ ( i * NY + j ) * NV + var ]) << \textcolor{stringliteral}{" "};
822         \}
823         out << \textcolor{stringliteral}{"\(\backslash\)n"};
824       \}
825       out << \textcolor{stringliteral}{"\(\backslash\)n"};
826     \}
827     out.close();
828   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_ab5fe26bc77435039388362aeab903313}\label{classLuna_1_1Mesh2D_ab5fe26bc77435039388362aeab903313}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!output\+\_\+var@{output\+\_\+var}}
\index{output\+\_\+var@{output\+\_\+var}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{output\+\_\+var()}{output\_var()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::output\+\_\+var (\begin{DoxyParamCaption}\item[{std\+::string}]{filename,  }\item[{const std\+::size\+\_\+t}]{var }\end{DoxyParamCaption}) const}



Output a single variable to a file with no nodal information. 


\begin{DoxyParams}{Parameters}
{\em filename} & Name of the file to output the data to \\
\hline
{\em var} & Variable index \\
\hline
\end{DoxyParams}


Definition at line 704 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
706   \{
707     std::ofstream out;
708     out.open( filename.c\_str() );
709     out.precision( 12 );
710     out.setf( std::ios::showpoint );
711     out.setf( std::ios::showpos );
712     out.setf( std::ios::scientific );
713     out.precision( 12 );
714     \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < NY; ++j )
715     \{
716       \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < NX; ++i )
717       \{
718         out << VARS[ ( i * NY + j ) * NV + var ] << \textcolor{stringliteral}{"\(\backslash\)n"};
719       \}
720     \}
721   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a21825e991e96d5cfad2dc9de68cf5f73}\label{classLuna_1_1Mesh2D_a21825e991e96d5cfad2dc9de68cf5f73}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!read@{read}}
\index{read@{read}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{read()}{read()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$class T$>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::read (\begin{DoxyParamCaption}\item[{std\+::string}]{filename,  }\item[{const bool}]{reset = {\ttfamily false} }\end{DoxyParamCaption})}



A simple method for reading data from a file. 


\begin{DoxyParams}{Parameters}
{\em filename} & Name of the file to read the data from \\
\hline
{\em reset} & Reset the mesh nodes using data from file \\
\hline
\end{DoxyParams}


Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().

\mbox{\Hypertarget{classLuna_1_1Mesh2D_acf187c6339ea8527fa70f2d5e74abe41}\label{classLuna_1_1Mesh2D_acf187c6339ea8527fa70f2d5e74abe41}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!read@{read}}
\index{read@{read}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{read()}{read()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$$>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ double $>$\+::read (\begin{DoxyParamCaption}\item[{std\+::string}]{filename,  }\item[{const bool}]{reset }\end{DoxyParamCaption})}



Definition at line 724 of file Mesh2\+D.\+h.



References Heat\+\_\+plot\+::x, and y.


\begin{DoxyCode}
725   \{
726     std::ifstream inFile;
727     inFile.open( filename.c\_str() );
728     inFile.precision( 12 );
729     inFile.setf( std::ios::showpoint );
730     inFile.setf( std::ios::showpos );
731     inFile.setf( std::ios::scientific );
732     \textcolor{keywordflow}{if} (!inFile) \{
733       \textcolor{keywordflow}{throw} Error( \textcolor{stringliteral}{"Mesh2D unable to open file"} );
734     \}
735 
736     \textcolor{keywordtype}{double} \hyperlink{namespaceHeat__plot_aa88370c16b85b784ccbde3ed88bc1991}{x}, \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y};
737     Vector<double> vals( NV );
738 
739     \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < NX; ++i )
740     \{
741       \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < NY; ++j )
742       \{
743         inFile >> \hyperlink{namespaceHeat__plot_aa88370c16b85b784ccbde3ed88bc1991}{x};
744         inFile >> \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y};
745         std::size\_t offset( ( i * NY + j ) * NV );
746         \textcolor{keywordflow}{for} ( std::size\_t v = 0; v < NV; ++v )
747         \{
748           inFile >> vals[ v ];
749           VARS[ offset++ ] = vals[ v ];
750         \}
751         \textcolor{comment}{// Check the mesh}
752         \textcolor{keywordflow}{if} ( !reset )
753             \{
754                 \textcolor{keywordflow}{if} ( ( std::abs( x - X\_NODES[ i ] ) > 1.e-6 ) ||
755                ( std::abs( y - Y\_NODES[ j ] ) > 1.e-6 ) )
756                 \{
757                     std::cout << \textcolor{stringliteral}{" Read x = "} << x << \textcolor{stringliteral}{" Expected x = "}
758                       << X\_NODES[ i ] << std::endl;
759             std::cout << \textcolor{stringliteral}{" Read y = "} << y << \textcolor{stringliteral}{" Expected y = "}
760                       << Y\_NODES[ i ] << std::endl;
761             std::string problem;
762             problem  = \textcolor{stringliteral}{" Mesh2D trying to read from file with different nodal"};
763             problem += \textcolor{stringliteral}{" points."};
764                     \textcolor{keywordflow}{throw} Error( problem );
765                 \}
766             \}
767             \textcolor{keywordflow}{else}
768             \{
769                 X\_NODES[ i ] = \hyperlink{namespaceHeat__plot_aa88370c16b85b784ccbde3ed88bc1991}{x};
770           Y\_NODES[ j ] = \hyperlink{ODE__BVP__test_8cpp_adf764cbdea00d65edcd07bb9953ad2b7ae1f9fdb8b786c63efc4ce44eeacd17f2}{y};
771             \}
772       \}
773     \}
774     inFile.close();
775   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a3874356b327d21ac65b16d181a4240f3}\label{classLuna_1_1Mesh2D_a3874356b327d21ac65b16d181a4240f3}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!remesh@{remesh}}
\index{remesh@{remesh}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{remesh()}{remesh()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::remesh (\begin{DoxyParamCaption}\item[{const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \&}]{newX,  }\item[{const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \&}]{newY }\end{DoxyParamCaption})}



Interpolate the mesh data (bilinearly) into a new mesh. 


\begin{DoxyParams}{Parameters}
{\em newX} & New x nodal points \hyperlink{classLuna_1_1Vector}{Vector} \\
\hline
{\em newY} & New y nodal points \hyperlink{classLuna_1_1Vector}{Vector} \\
\hline
\end{DoxyParams}


Definition at line 383 of file Mesh2\+D.\+h.



References Luna\+::\+Mesh2\+D$<$ T $>$\+::coord(), Luna\+::\+Mesh2\+D$<$ T $>$\+::get\+\_\+nodes\+\_\+vars(), and Luna\+::\+Vector$<$ T $>$\+::size().



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
385   \{
386     \textcolor{comment}{// check start & end}
387     \textcolor{keywordflow}{if} ( std::abs( X\_NODES[ 0 ] - newX[ 0 ] ) > 1.e-10 ||
388          std::abs( X\_NODES[ X\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 ] - newX[ newX.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 ] )
389          > 1.e-10 )
390     \{
391       std::string problem;
392       problem = \textcolor{stringliteral}{" The Mesh2D.remesh1 method has been called with a passed \(\backslash\)n"};
393       problem += \textcolor{stringliteral}{" X coordinate vector that has different start and/or \(\backslash\)n"};
394       problem += \textcolor{stringliteral}{" end points from the instantiated object. \(\backslash\)n"};
395       \textcolor{keywordflow}{throw} Error( problem );
396     \}
397     \textcolor{comment}{// check monotonic node positions}
398     \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < newX.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++i )
399     \{
400       \textcolor{keywordflow}{if} ( newX[ i ] >= newX[ i + 1 ] )
401       \{
402         std::string problem;
403         problem = \textcolor{stringliteral}{" The Mesh2D.remesh1 method has been passed \(\backslash\)n"};
404         problem += \textcolor{stringliteral}{" a non-monotonic X coordinate vector. \(\backslash\)n"};
405         \textcolor{keywordflow}{throw} Error( problem );
406       \}
407     \}
408     \textcolor{comment}{// check start and end}
409     \textcolor{keywordflow}{if} ( std::abs( Y\_NODES[ 0 ] - newY[ 0 ] ) > 1.e-10 ||
410          std::abs( Y\_NODES[ Y\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 ] - newY[ newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 ] )
411          > 1.e-10 )
412     \{
413       std::string problem;
414       problem = \textcolor{stringliteral}{" The Mesh2D.remesh1 method has been called with a passed \(\backslash\)n"};
415       problem += \textcolor{stringliteral}{" Y coordinate vector that has different start and/or \(\backslash\)n"};
416       problem += \textcolor{stringliteral}{" end points from the instantiated object. \(\backslash\)n"};
417       \textcolor{keywordflow}{throw} Error( problem );
418     \}
419     \textcolor{comment}{// check monotonic node positions}
420     \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++i )
421     \{
422       \textcolor{keywordflow}{if} ( newY[ i ] >= newY[ i + 1 ] )
423       \{
424         std::string problem;
425         problem = \textcolor{stringliteral}{" The Mesh2D.remesh1 method has been passed \(\backslash\)n"};
426         problem += \textcolor{stringliteral}{" a non-monotonic Y coordinate vector. \(\backslash\)n"};
427         \textcolor{keywordflow}{throw} Error( problem );
428       \}
429     \}
430 
431     \textcolor{comment}{// new variables storage}
432     Vector<T> newvars( newX.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() * NV, 0.0 );
433 
434     \textcolor{comment}{// left boundary}
435     \{
436       std::size\_t xnode( 0 );
437       \textcolor{comment}{// bottom left corner copy}
438       \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} var = 0; var < NV; ++var )
439       \{
440         newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + 0 ) * NV + var ] =
441                                                   \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( 0, 0 )[ var ];
442       \}
443       \textcolor{keywordflow}{for} ( std::size\_t ynode = 1; ynode < newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++ynode )
444       \{
445         std::size\_t left\_i( 0 );  \textcolor{comment}{// bracketing index}
446         std::size\_t below\_j( 0 ); \textcolor{comment}{// bracketing index}
447         \textcolor{keywordtype}{double} deltaY( 0.0 );
448         \textcolor{comment}{// loop through the source mesh and find the bracket-nodes}
449         \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < Y\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++j )
450         \{
451           \textcolor{keywordflow}{if} ( ( Y\_NODES[ j ] <= newY[ ynode ] ) &&
452                ( newY[ ynode ] < Y\_NODES[ j + 1 ] ) )
453           \{
454             below\_j = j;
455             deltaY = newY[ ynode ] - Y\_NODES[ j ];
456           \}
457         \}
458         Vector<T> dvarsdY = ( \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j + 1 )
459                               - \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j ) )
460                            / ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j + 1 ).second
461                               - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).second );
462         Vector<T> interpolated\_vars =   \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j )
463                                       + dvarsdY * deltaY;
464         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
465         \{
466           newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + ynode ) * NV + var ] =
467                                                        interpolated\_vars[ var ];
468         \}
469       \}
470       \textcolor{comment}{// top left corner copy}
471       \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
472       \{
473         newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 ) * NV + var ] =
474         \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( 0, NY - 1 )[ var ];
475       \}
476     \}
477     \textcolor{comment}{// right boundary}
478     \{
479       std::size\_t xnode( newX.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 );
480       \textcolor{comment}{// bottom right corner copy}
481       \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
482       \{
483         newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + 0 ) * NV + var ] =
484         \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( NX - 1, 0 )[ var ];
485       \}
486       \textcolor{keywordflow}{for} ( std::size\_t ynode = 1; ynode < newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++ynode )
487       \{
488         std::size\_t left\_i( X\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 );  \textcolor{comment}{// bracketing index}
489         std::size\_t below\_j( 0 ); \textcolor{comment}{// bracketing index}
490         \textcolor{keywordtype}{double} deltaY( 0.0 );
491         \textcolor{comment}{// loop through the source mesh and find the bracket-nodes}
492         \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < Y\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++j )
493         \{
494           \textcolor{keywordflow}{if} ( ( Y\_NODES[ j ] <= newY[ ynode ] ) &&
495                ( newY[ ynode ] < Y\_NODES[ j + 1 ] ) )
496           \{
497             below\_j = j;
498             deltaY = newY[ ynode ] - Y\_NODES[ j ];
499           \}
500         \}
501         Vector<T> dvarsdY = ( \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j + 1 )
502                               - \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j ) )
503                            / ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j + 1 ).second
504                               - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).second );
505         Vector<T> interpolated\_vars =   \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j )
506                                       + dvarsdY * deltaY;
507         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
508         \{
509           newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + ynode ) * NV + var ] =
510                                                        interpolated\_vars[ var ];
511         \}
512       \}
513       \textcolor{comment}{// bottom right corner copy}
514       \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
515       \{
516         newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 ) * NV + var ] =
517         \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( NX - 1, NY - 1 )[ var ];
518       \}
519     \}
520     \textcolor{comment}{// bottom boundary}
521     \{
522       std::size\_t ynode( 0 );
523       \textcolor{keywordflow}{for} ( std::size\_t xnode = 1; xnode < newX.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++xnode )
524       \{
525         std::size\_t left\_i( 0 );  \textcolor{comment}{// bracketing index}
526         std::size\_t below\_j( 0 ); \textcolor{comment}{// bracketing index}
527         \textcolor{keywordtype}{double} deltaX( 0.0 );
528         \textcolor{comment}{// loop through the source mesh and find the bracket-nodes}
529         \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < X\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++i )
530         \{
531           \textcolor{keywordflow}{if} ( ( X\_NODES[ i ] <= newX[ xnode ] ) &&
532                ( newX[ xnode ] < X\_NODES[ i + 1 ] ) )
533           \{
534             left\_i = i;
535             deltaX = newX[ xnode ] - X\_NODES[ i ];
536           \}
537         \}
538         Vector<T> dvarsdX = ( \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i + 1, below\_j )
539                               - \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j ) )
540                            / ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i + 1, below\_j ).first
541                               - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).first );
542         Vector<T> interpolated\_vars =   \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j )
543                                       + dvarsdX * deltaX;
544         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
545         \{
546           newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + ynode ) * NV + var ] =
547                                                        interpolated\_vars[ var ];
548         \}
549       \}
550     \}
551     \textcolor{comment}{// top boundary}
552     \{
553       std::size\_t ynode( newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 );
554       \textcolor{keywordflow}{for} ( std::size\_t xnode = 1; xnode < newX.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++xnode )
555       \{
556         std::size\_t left\_i( 0 );  \textcolor{comment}{// bracketing index}
557         std::size\_t below\_j( Y\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1 ); \textcolor{comment}{// bracketing index}
558         \textcolor{keywordtype}{double} deltaX( 0.0 );
559         \textcolor{comment}{// loop through the source mesh and find the bracket-nodes}
560         \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < X\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++i )
561         \{
562           \textcolor{keywordflow}{if} ( ( X\_NODES[ i ] <= newX[ xnode ] ) &&
563                ( newX[ xnode ] < X\_NODES[ i + 1 ] ) )
564           \{
565             left\_i = i;
566             deltaX = newX[ xnode ] - X\_NODES[ i ];
567           \}
568         \}
569         Vector<T> dvarsdX = ( \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i + 1, below\_j )
570                               - \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j ) )
571                            / ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i + 1, below\_j ).first
572                               - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).first );
573         Vector<T> interpolated\_vars =   \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j )
574                                       + dvarsdX * deltaX;
575         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
576         \{
577           newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + ynode ) * NV + var ] =
578                                                        interpolated\_vars[ var ];
579         \}
580       \}
581     \}
582     \textcolor{comment}{// loop thru interior nodes of the destination mesh one node at a time}
583     \textcolor{keywordflow}{for} ( std::size\_t xnode = 1; xnode < newX.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++xnode )
584     \{
585       \textcolor{keywordflow}{for} ( std::size\_t ynode = 1; ynode < newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++ynode )
586       \{
587         std::size\_t left\_i( 0 );  \textcolor{comment}{// bracketing index}
588         std::size\_t below\_j( 0 ); \textcolor{comment}{// bracketing index}
589         \textcolor{comment}{// loop through the source mesh and find the bracket-nodes}
590         \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < X\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++i )
591         \{
592           \textcolor{keywordflow}{if} ( ( X\_NODES[ i ] <= newX[ xnode ] ) &&
593                ( newX[ xnode ] < X\_NODES[ i + 1 ] ) )
594           \{
595             left\_i = i;
596           \}
597         \}
598         \textcolor{comment}{// loop through the source mesh and find the bracket-nodes}
599         \textcolor{keywordflow}{for} ( std::size\_t j = 0; j < Y\_NODES.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() - 1; ++j )
600         \{
601           \textcolor{keywordflow}{if} ( ( Y\_NODES[ j ] <= newY[ ynode ] ) &&
602                ( newY[ ynode ] < Y\_NODES[ j + 1 ] ) )
603           \{
604             below\_j = j;
605           \}
606         \}
607         Vector<T> dvarsdX = ( \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i + 1, below\_j )
608                               - \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j ) )
609                            / ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i + 1, below\_j ).first
610                               - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).first );
611         Vector<T> dvarsdY = ( \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j + 1 )
612                               - \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j ) )
613                            / ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j + 1 ).second
614                               - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).second );
615 
616         Vector<T> interpolated\_vars\_bottom =
617                     ( \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j ) *
618                       ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i + 1, below\_j ).first - newX[ xnode ] )
619                       + \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i + 1, below\_j )
620                       * ( newX[ xnode ] - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).first ) )
621                     / ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i + 1, below\_j ).first
622                       - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).first );
623 
624         Vector<T> interpolated\_vars\_top =
625           ( \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i, below\_j + 1 )
626           * ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i + 1, below\_j + 1 ).first - newX[ xnode ] )
627           + \hyperlink{classLuna_1_1Mesh2D_ae91c7515960ecedf43e4ed3f411080a1}{get\_nodes\_vars}( left\_i + 1, below\_j + 1 )
628           * ( newX[ xnode ] - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j + 1 ).first ) ) /
629           ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i + 1, below\_j + 1 ).first
630           - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j + 1 ).first );
631 
632         Vector<T> interpolated\_vars =
633           (  interpolated\_vars\_bottom * ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j + 1 ).second
634           - newY[ ynode ] ) +  interpolated\_vars\_top
635           * ( newY[ ynode ] - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).second ) ) /
636           ( \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j + 1 ).second
637           - \hyperlink{classLuna_1_1Mesh2D_add4d12155922731ccf59fe4454699eed}{coord}( left\_i, below\_j ).second );
638 
639         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
640         \{
641           newvars[ ( xnode * newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}() + ynode ) * NV + var ] =
642                                                        interpolated\_vars[ var ];
643         \}
644       \}
645     \}
646     \textcolor{comment}{// finally replace the old nodes with the new ones}
647     X\_NODES = newX;
648     Y\_NODES = newY;
649     NX = newX.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}();
650     NY = newY.\hyperlink{classLuna_1_1Vector_ac9b6ed7a0df401728f27c193fbc8f4d8}{size}();
651     VARS = newvars;
652   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a40ceeeb39bb653c05a4b5c084e676e34}\label{classLuna_1_1Mesh2D_a40ceeeb39bb653c05a4b5c084e676e34}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!set\+\_\+nodes\+\_\+vars@{set\+\_\+nodes\+\_\+vars}}
\index{set\+\_\+nodes\+\_\+vars@{set\+\_\+nodes\+\_\+vars}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{set\+\_\+nodes\+\_\+vars()}{set\_nodes\_vars()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::set\+\_\+nodes\+\_\+vars (\begin{DoxyParamCaption}\item[{const std\+::size\+\_\+t}]{nodex,  }\item[{const std\+::size\+\_\+t}]{nodey,  }\item[{const \hyperlink{classLuna_1_1Vector}{Vector}$<$ T $>$ \&}]{vec }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set the variables stored at a specified node. 


\begin{DoxyParams}{Parameters}
{\em nodex} & Node index ( x-\/axis ) \\
\hline
{\em nodey} & Node index ( y-\/axis ) \\
\hline
{\em vec} & \hyperlink{classLuna_1_1Vector}{Vector} of variables \\
\hline
\end{DoxyParams}


Definition at line 260 of file Mesh2\+D.\+h.



References Luna\+::\+Vector$<$ T $>$\+::size().



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
263   \{
264     \textcolor{keywordflow}{if} ( nodex > NX - 1 || nodey > NY - 1 || nodex < 0 || nodey < 0 )
265     \{
266       std::string problem;
267       problem = \textcolor{stringliteral}{" The Mesh2D.set\_nodes\_vars method is trying to \(\backslash\)n"};
268       problem += \textcolor{stringliteral}{" access a nodal point that is not in the mesh. \(\backslash\)n"};
269       \textcolor{keywordflow}{throw} Error( problem );
270     \}
271     \textcolor{keywordflow}{if} ( vec.size() > NV )
272     \{
273       std::string problem;
274       problem = \textcolor{stringliteral}{" The Mesh2D.set\_nodes\_vars method is using a vector that \(\backslash\)n"};
275       problem += \textcolor{stringliteral}{" has more entries than variables stored in the mesh. \(\backslash\)n"};
276       \textcolor{keywordflow}{throw} Error( problem );
277     \}
278     \textcolor{comment}{// assign contents of vec to the member data}
279     std::size\_t offset( ( nodex * NY + nodey ) * NV );
280     \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < NV; ++var )
281     \{
282       VARS[ offset++ ] = vec[ var ];
283     \}
284   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a41e9d12ae3f05af7a12cd05690fff29c}\label{classLuna_1_1Mesh2D_a41e9d12ae3f05af7a12cd05690fff29c}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!square\+\_\+integral2D@{square\+\_\+integral2D}}
\index{square\+\_\+integral2D@{square\+\_\+integral2D}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{square\+\_\+integral2\+D()}{square\_integral2D()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
T \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::square\+\_\+integral2D (\begin{DoxyParamCaption}\item[{std\+::size\+\_\+t}]{var = {\ttfamily 0} }\end{DoxyParamCaption}) const}



Numerically integrate the square of the absolute value over the domain. 


\begin{DoxyParams}{Parameters}
{\em var} & Variable index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The integral of the square of the absolute value over the domain 
\end{DoxyReturn}


Definition at line 903 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
904   \{
905     T sum( 0.0 );
906     \textcolor{keywordtype}{double} dx( 0.0 );
907     \textcolor{keywordtype}{double} dy( 0.0 );
908     \textcolor{comment}{// Sum over the elements}
909     \textcolor{keywordflow}{for} ( std::size\_t i=0; i < NX - 1; ++i )
910     \{
911       dx = X\_NODES[ i + 1 ] - X\_NODES[ i ];
912       \textcolor{keywordflow}{for} ( std::size\_t j=0; j < NY - 1; ++j )
913       \{
914         dy = Y\_NODES[ j + 1 ] - Y\_NODES[ j ];
915         sum += 0.25 * dx * dy * (
916             std::pow( std::abs( VARS[ ( i * NY + j ) * NV + var ] ), 2 )
917           + std::pow( std::abs( VARS[ ( ( i + 1 ) * NY + j ) * NV + var ] ), 2 )
918           + std::pow( std::abs( VARS[ ( i * NY + j + 1 ) * NV + var ] ), 2 )
919           + std::pow( std::abs( VARS[ ( ( i + 1 ) * NY + j + 1 ) * NV + var ] )
920                                                                         , 2 ) );
921       \}
922     \}
923     \textcolor{keywordflow}{return} sum;
924   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a8a860fec0e116f915dcac68476d9e7d8}\label{classLuna_1_1Mesh2D_a8a860fec0e116f915dcac68476d9e7d8}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!xnodes@{xnodes}}
\index{xnodes@{xnodes}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{xnodes()}{xnodes()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \& \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::xnodes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Return A vector of the x-\/nodal positions for this mesh. 

\begin{DoxyReturn}{Returns}
A the mesh x nodes \hyperlink{classLuna_1_1Vector}{Vector} 
\end{DoxyReturn}


Definition at line 350 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
351   \{
352     \textcolor{keywordflow}{return} X\_NODES;
353   \}
\end{DoxyCode}
\mbox{\Hypertarget{classLuna_1_1Mesh2D_a7644446cbd5b3f1dc40f1fd8f9137ff3}\label{classLuna_1_1Mesh2D_a7644446cbd5b3f1dc40f1fd8f9137ff3}} 
\index{Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}!ynodes@{ynodes}}
\index{ynodes@{ynodes}!Luna\+::\+Mesh2D@{Luna\+::\+Mesh2D}}
\subsubsection{\texorpdfstring{ynodes()}{ynodes()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
const \hyperlink{classLuna_1_1Vector}{Vector}$<$ double $>$ \& \hyperlink{classLuna_1_1Mesh2D}{Luna\+::\+Mesh2D}$<$ T $>$\+::ynodes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Return A vector of the y-\/nodal positions for this mesh. 

\begin{DoxyReturn}{Returns}
A the mesh y nodes \hyperlink{classLuna_1_1Vector}{Vector} 
\end{DoxyReturn}


Definition at line 356 of file Mesh2\+D.\+h.



Referenced by Luna\+::\+Mesh2\+D$<$ T $>$\+::$\sim$\+Mesh2\+D().


\begin{DoxyCode}
357   \{
358     \textcolor{keywordflow}{return} Y\_NODES;
359   \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/\+Luna/\hyperlink{Mesh2D_8h}{Mesh2\+D.\+h}\end{DoxyCompactItemize}
